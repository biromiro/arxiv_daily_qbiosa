# Abstract

Personalized vaccines and T-cell immunother- apies depend critically on identifying peptide- MHC class I (pMHC-I) interactions capable of eliciting potent immune responses. However, cur- rent benchmarks and models inherit biases present in mass-spectrometry and binding-assay datasets, limiting the discovery of novel peptide ligands. To address this issue, we introduce a structure-guided benchmark of pMHC-I peptides designed using diffusion models conditioned on crystal structure interaction distances. Spanning 27 high-priority HLA alleles, this benchmark is independent of previously characterized peptides yet reproduces canonical anchor residue preferences, indicat- ing structural generalization without experimen- tal MS dataset bias and reduced systematic bias. Using this resource, we demonstrate that state-of- the-art sequence-based predictors perform poorly at recognizing the binding potential of these struc- turally stable designs, indicating allele-specific limitations invisible in conventional evaluations. Our geometry-aware design pipeline yields pep- tides with high predicted structural integrity and higher residue diversity than existing datasets, rep- resenting a key resource for unbiased model train- ing and evaluation. Our code and data are avail- able at: https://github.com/sermare/struct-mhc- dev.

1.

# Introduction

Peptide–MHC class I (pMHC-I) interactions are central to adaptive immunity, enabling cytotoxic T cells to recognize and eliminate infected or cancerous cells (Chaplin, 2010; Hilf et al., 2019). Predictors of pMHC-I binding have be-

1Center for Computational Biology, University of California, Berkeley, Berkeley, California, USA 2Department of Electrical Engineering and Computer Sciences, University of California, Berkeley, Berkeley, California, USA 3Chan Zuckerberg Biohub, San Francisco, California, USA. Correspondence to: Sergio Emilio Mares <sergio.mares@berkeley.edu>.

The 2 nd International Conference on Machine Learning in Gener- ative AI and Biology Workshop. Copyright 2025 by the author(s).

1

come widely used tools for personalized T-cell immunother- apies and modern vaccine design (Saxena et al., 2025). Given the vast combinatorial diversity of > 100, 000, 000 distinct peptides, and after accounting for polymorphisms, insertions, deletions, and aberrant splicing, experimentally mapping all binding peptides is infeasible (Yewdell et al., 2003). Accurate algorithmic predictions are essential in vac- cine trial design and necessitate precise in silico prediction methods to prioritize candidate peptides for immunothera- peutic development (Hilf et al., 2019; Walz et al., 2015). De- spite substantial progress, current pMHC-I prediction meth- ods face important limitations. Most state-of-the-art models are sequence-based and trained on a large library of known binders from public databases, such as the Immune-Epitope Database (IEDB) which contains a library of > 106 pMHCs (Vita et al., 2025). These datasets predominantly originate from mass-spectrometry (MS) immunopeptidomics (Sark- izova et al., 2020) and in vitro binding assays and thus carry experimental biases. One well-documented bias is the under-detection of cysteine-containing peptides in standard MS workflows, which in turn causes such peptides to be under-represented in databases and often missed by trained predictors (Bruno et al., 2023; Dincer et al., 2022; Mallick et al., 2007). Furthermore, many benchmarks rely on sim- ilar experimental data for evaluation, potentially inflating performance by testing on peptide sequences with distri- butions similar to model training sets. This over-reliance on biased datasets and narrow test sets raises concerns that reported accuracy overstates real-world generalization ca- pacity (Machaca et al., 2024).

To address these challenges, we introduce a structure- conditioned diffusion model for pMHC-I peptide generation. Our diffusion-based generative model explicitly conditions on the three-dimensional structure of the MHC-I binding groove. By leveraging this structural context, it designs peptides predicted to be compatible with the binding pocket of a given MHC allele, increasing their predicted structural validity. This approach enables exploration of peptide se- quence space beyond the biases present in current databases, yielding novel out-of-distribution peptides guided by struc- tural binding preferences. By generating plausible yet un- conventional peptides, our model expands the landscape of candidate peptide sequences and provides challenging new test cases for evaluating existing predictors.













Generation of structure-guided pMHC-I libraries using Diffusion Models

Figure 1. Overview of the structure-guided generative pipeline for designing high-affinity peptides for MHC class I molecules.

2. Data and Methods

2.1. Dataset

We collected 189 peptide–MHC class I crystal struc- tures from the Protein Data Bank (PDB) (Berman et al., 2003), covering 27 distinct human HLA alleles, accessed 23 April 2025. Only peptides of length 9–11 amino acids were included. Structures were required to have crystallo- graphic resolution ≤ 3.5 ˚A, providing sufficient detail to resolve hydrogen bonds and van der Waals contacts typ- ically observed at this distance threshold. We excluded structures containing missing peptide residues, non-standard amino acids, incomplete HLA annotations, or redundant complexes of identical peptide–allele pairs with a final set of 119 pMHC structures (Supplementary Table 1).

Contact computation. For each peptide residue i and each MHC residue j, we calculated the minimum heavy- atom distance across all atoms of residues i and j, recording this value as dmin . We systematically evaluated thresholds from 1.0 to 10.5 ˚A in 0.5 ˚A increments to characterize the distribution of pMHC proximities. While distances greater than 6–7 ˚A rarely represent direct physical interactions, including the full range allowed us to observe the decay of pairwise contacts with distance.

ij

We followed a 3.5 ˚A threshold to define hydrogen bonds and direct atom–atom contacts observed in pMHC struc- tures (Chaurasia et al., 2021; Anjanappa et al., 2020; Li et al., 2016), while slightly larger cutoffs up to 5.0 ˚A have been applied to capture looser pMHC associations (Blevins et al., 2016). Approximately 5.7% of pMHC residue pairs fall within ≤ 3.5 ˚A and 16.8% within ≤ 5.0 ˚A. Based on these empirical distributions and established interaction cri- teria, we classified residue pairs into two categories: close ij ≤ 3.5 ˚A, typically corresponding to van contacts when dmin

der Waals interactions and candidate hydrogen bonds, and ij ≤ 5.0 ˚A, representing extended contacts when 3.5 < dmin weaker, less direct associations at the binding interface.

Validation of distance cutoffs. To assess the robustness of these thresholds, we examined the empirical distribu- tion of minimum heavy-atom distances across the dataset and confirmed stability of the observed proportions through bootstrap resampling. The 3.5 ˚A cutoff consistently cap- tured the closest and most structurally constrained residue pairs, whereas the 5.0 ˚A cutoff provided broader coverage of the binding interface. Contact count distributions further indicated that individual peptide residues typically formed 1–4 close contacts (≤ 3.5 ˚A) with MHC residues.

2.2. Generative Pipeline

Our pipeline (Fig. 1) begins with the crystallized MHC– peptide structure. We first remove the peptide coordinates, preserving the MHC scaffold and positional definitions of hot-spot residues. RFdiffusion (Watson et al., 2023) was run for 50 diffusion steps to generate peptide backbone candidates, with hot-spot contacts enforced as geometric constraints to encourage high-affinity binding. We specified a peptide length window of 9–11 residues, did not impose symmetry, and used a sampling temperature of 0.5.

Each RFdiffusion-generated backbone was next threaded through ProteinMPNN (Dauparas et al., 2022) to assign peptide side-chain identities while keeping the MHC scaf- fold fixed. The peptide coordinates were isolated, while the entire complex backbone was provided to ProteinMPNN in --complex mode. For each backbone, we sampled N = 64 sequences at a temperature of 0.5, with cysteine residues disabled (rm_aa=C) to prevent disulfide-driven artifacts. Sequences were ranked by their negative log- likelihood (NLL), and the top five were retained for struc-

2

Current Binding Aﬃnity DataHigh Binding AﬃnityExperimental Biases: Trypsin, previously reported anchoring residues, viral proteins, etc. Full Sequence Space…AQGSDVSLTACKVXXXXXXXXXDiﬀuse over the MHC SequenceSample from structure-guided sequence space+RFProteinMPNNAF2Input Structures of  MHC + Masked Epitope and condition on the contact mapsCurrent Binding Aﬃnity DataHigh Binding AﬃnityExperimental Biases: Trypsin, previously reported anchoring residues, viral proteins, etc. Full Sequence SpaceStructure-guided Epitopes Generation of structure-guided pMHC-I libraries using Diffusion Models

tural evaluation.

The top ProteinMPNN sequences were folded with AlphaFold2-Multimer (AF2) binder with the HLA heavy chain and β2-microglobulin kept intact. AF2 was run with model 1 multimer v3, num recycles=6, and with- out templates. For each design, we recorded the mean per- residue pLDDT over peptide positions and the interface pTM (iPTM) score. Peptides with pLDDT ≥ 0.80 were retained as high-confidence designs.

2.3. Diffusion model refinement and bias

The authors of RFdiffusion and ProteinMPNN have previ- ously reported amino-acid composition biases in generative design tasks, such as a strong preference for proline in loop scaffolds where Rosetta-based methods failed (Dauparas et al., 2022). Such behavior, while sometimes beneficial for rigidifying flexible regions, can also reflect unintended model artifacts. Similar biases may arise in peptide de- sign tasks, leading to overrepresentation of certain residues across alleles or positions. To evaluate potential model- driven signals in our structure-guided pMHC peptides, we quantified amino-acid usage both globally and at each se- quence position for each HLA allele. Enrichment was then assessed relative to a position-specific background estimated from the high-confidence anchoring set (Supp. Fig. S2).

2.4. Position Weight Matrix Normalization

To account for amino acid usage biases, we normalized the enrichment plots using background frequencies from the human proteome. For the sequence logo plots, the position- specific probability matrices were corrected by dividing by the corresponding background frequencies, ensuring that observed enrichments reflect deviations from both the proteome baseline and biases introduced by the diffusion model.

2.5. Models Evaluated

Binding affinities are predicted by MHC-Flurry (O’Donnell et al., 2020), NetMHCpan (McInnes et al., 2018), HLApollo (Thrift et al., 2024), HLAthena (Sarkizova et al., 2020), MixMHCpred (Bassani-Sternberg et al., 2017), MHC- Nuggets (Shao et al., 2020), and ESMCBA, a fine-tuned ESM-Cambrian model (Mares et al., 2025).

2.6. Additional Benchmarking Datasets

We employed three additional benchmarking datasets: 1. IEDB database with peptides after 2020, eliminating data leakage for most models’ training data. 2. A constructed dataset with preservation of the anchoring residues follow- ing the same distribution of peptides observed in the public dataset, and the randomly generated rest of the sequence. 3.

A list of 9-11-mers auto-regressively generated with ESM2 (Lin et al., 2023), starting from an initial random token and sampling each residue from the model’s predictive distribu- tions. We ensured independence of the dataset by removing any overlapping peptides between this generated pipeline and the public databases.

3. Results

3.1. Allele-aware peptide similarity

To investigate whether generated peptides recapitulate allele-specific binding preferences, we constructed Posi- tion Weight Matrices (PWMs) from peptides with high- confidence structures. Pairwise Jensen–Shannon (JS) dis- tances were then computed between allele-specific PWMs to quantify motif similarity.

The resulting distance matrix (Supp. Fig. S1) reveals that peptides generated for the same allele cluster together, with lower intra-allele divergences compared to inter-allele com- parisons. Broad allele family structure is visible; HLA-A and HLA-B, and within-family similarities (e.g., A02 al- leles) are stronger than across families (e.g., HLA-A vs HLA-B).

Figure 2. Predicted interface pTM scores and AlphaFold pLDDT values for peptides with and without anchor matches.

3

0.00.20.40.60.81.0AlphaFold pLDDTNo Anchor Match0.00.20.40.60.81.0Interface pTM score0.00.20.40.60.81.0AlphaFold pLDDTBoth Anchor Match10203040506070Point density (KDE)10203040506070Point density (KDE)Generation of structure-guided pMHC-I libraries using Diffusion Models

3.2. Recapitulating canonical anchors align with higher

predicted structural confidence

We tested whether generated peptides containing canonical anchor residues yielded higher-confidence structural pre- dictions. Canonical anchors are expected to recover the characteristic MHC-I binding motif and, if correctly cap- tured, should also yield more confident model predictions compared to peptides without anchors.

The interface predicted TM-score (iPTM) is a metric from AlphaFold that estimates the accuracy of inter-chain packing in protein–protein or protein–ligand complexes, providing a confidence measure for modeled interfaces. Alongside per-residue pLDDT, we used iPTM to assess model cer- tainty. The presence of canonical anchors systematically shifted the distribution toward higher iPTM and pLDDT scores (Fig. 2). We evaluated HLA-A*02:01 peptides lack- ing anchors displayed broader, lower-confidence distribu- tions, whereas those containing both position-2 (P2) and P Ω anchors were enriched with higher iPTM and pLDDT, with a highly significant difference confirmed by the Mann– Whitney test (p < 4.5 × 10−75).

These results demonstrate that canonical anchors not only recover expected MHC-I binding motifs but also enhance model confidence in structure predictions.

3.3. Experimental Validation with orthogonal unbiased

data

EpiScan is a high-throughput, cell-based platform that presents bar-coded peptide libraries on the surface of MHC- I molecules and quantifies their relative presentation by deep sequencing. Because it bypasses mass-spectrometry and in vitro binding assays, EpiScan provides an unbiased measure- ment of peptide presentation (Bruno et al., 2023). EpiScan’s study tested >500,000 peptides and found >40,000 pep- tides that bound to HLA-A*02:01 and >17,000 for HLA- B*57:01. Our structure-guided diffusion library comple- ments EpiScan by generating anchor-compatible peptides that explore under-sampled regions in silico, mitigating di- versity limitations imposed by experimental sampling.

Enrichment in HLA-A*02:01 and HLA-B*57:01 In HLA-A*02:01, canonical aliphatic anchors are observed in EpiScan, with Valine strongly enriched at P Ω and Leucine enriched at both P2 and P Ω (Supp. Fig. S3). Our library recapitulates these canonical signals, recovering the Va- line enrichment at P Ω and the Leucine signal at P2 (Supp. Fig. S4).

In HLA-B*57:01, Tryptophan, a bulky aromatic hydropho- bic residue, is the dominant canonical anchor at P Ω. This enrichment is captured clearly in both EpiScan and our gen- erated library, though with a reduced magnitude in the latter

(Supp. Fig. S5). Threonine, a small polar residue, is also enriched at P2 and P8 in EpiScan. Although not enriched at the canonical classical P2 in our epitopes of this allele, we recover the P8 signal (Supp. Fig. S6).

In addition to recovering canonical anchor motifs, we also observe allele-independent amino-acid biases that are con- sistent with previously reported artifacts in RFdiffusion and ProteinMPNN. These biases appear as low-variance enrich- ments across alleles (e.g., underrepresentation of cysteine and overrepresentation of certain loop-rigidifying residues), suggesting a model-driven rather than biological origin. To account for non-biological amino-acid biases introduced by the generative models, we corrected each allele-specific PWMs against a positional background distribution esti- mated from the full anchoring set. The resulting sequence lo- gos highlight allele-specific enrichments above background rather than global design artifacts (Supp. Fig. S7).

3.4. Evaluating Novelty and Binding Potential Against

Public Datasets

To quantify how our designed HLA-A*02:01 peptides differ from existing public epitopes, we compared their amino acid composition to the IEDB background using Jensen- Shannon distance while simultaneously evaluating predicted binding affinity. Anchor-preserved sequences are statisti- cally closer to IEDB distributions and consistently display higher predicted binding (Fig. 3), whereas globally sam- pled and structure-guided sequences explore more novel composition space. These orthogonal metrics demonstrate that our approach balances novelty with functional potential, highlighting how structural constraints (anchor preservation) trade off against diversity and affinity, while unconstrained and confidence-filtered designs can escape known biases yet remain structurally plausible binders.

Additionally, these generated peptides lie outside the train- ing distribution, and thus their true binding capacity remains unknown. This is precisely the motivation of this study, which seeks to test whether such novel out-of-distribution sequences can function as binders.

Sequence Novelty and Latent Space of Generated Designs

To further contextualize these compositional differences, we examined the latent embedding space of peptide se- quences from the model’s final hidden layer using UMAP (Supplementary Fig. S8). This analysis supports the PWM- based distances: diffusion-generated epitopes cluster into distinct regions of latent space, separated from random con- trols and anchor-permutation baselines. Together, the PWM comparisons and embedding analyses demonstrate that our diffusion-based pipeline explores novel yet structured se- quence space, extending beyond biases of current public

4

Generation of structure-guided pMHC-I libraries using Diffusion Models

Performance on Permutation-Test Peptides

To test predictors’ robustness to subtle sequence perturba- tions, we next assessed performance on anchor-preserved permutation-test peptides. Ideally, predictors should down- rank these controls, yielding AUROCs well above 0.5), re- flecting their non-physiological sequence context. However, we observed AUROCs ranging from 0.71 (HLApollo) to 0.93 (HLAthena and NetMHCpan), indicating that predic- tors naively assigned these peptides relatively high scores. This result reveals a troubling sensitivity to subtle global sequence context perturbations beyond anchor positions, highlighting a critical vulnerability in current predictive approaches.

Performance on Structure-Guided Diffusion Designs

Finally, we evaluated model performance on peptides explic- itly designed to structurally complement the MHC binding pocket (structure-guided designs with pLDDT > 0.8). We first evaluated them against the random generated peptides. All methods’ AUROCs show clear ability to distinguish the diffusion peptides from random noise. However, all methods achieved poor discriminative performance against validated strong binders, with AUROCs ranging from 0.03 (MHC Nugget) to 0.19 (Apollo). This performance clearly exposes a significant blind spot: current predictors are largely unable to recognize structurally plausible peptides, highlighting critical limitations in their generalization capabilities and underscoring the need for structurally aware training data.

4. Discussion and limitations

Our study addresses critical limitations in pMHC-I bind- ing prediction by leveraging diffusion models conditioned on atomic-level interactions, effectively avoiding biases in- herent in mass-spectrometry and binding assay data. The structure-aware generative method introduced here chal- lenges current models, highlighting their inability to rec- ognize structurally valid, novel peptides that are out-of- distribution for their experimental training datasets. In par- ticular, our approach recapitulates canonical anchoring pref- erences observed in unbiased datasets such as EpiScan (for example, recovery of tryptophan, valine, and leucine an- chors) and shows that these residues systematically align with higher predicted structural confidence (iPTM and pLDDT). This anchor recovery provides confidence that our approach captures allele-specific motifs despite not be- ing trained directly on binding data. At the same time, our methodology expands the explored sequence space, gen- erating diverse peptides that probe regions of the epitope landscape underrepresented in current datasets.

Several limitations should be acknowledged. First, we observed a non-trivial enrichment of proline across alle-

Figure 3. JS distance to the IEDB background and binding affinity predictions.

datasets and traditional generative baselines.

3.5. Full ROC curve performance across peptide classes

For each predictor, we constructed Receiver Operating Char- acteristic (ROC) curves across four distinct peptide eval- uation classes and computed the Area Under the ROC (AUROC) to assess discriminative performance in HLA- A*02:01, since across alleles has the most training data in IEDB (Fig. 4).

Performance on Experimentally Validated Binders

To establish a baseline, we evaluated each predictor’s ability to distinguish experimentally validated binders from other peptides. All methods performed moderately, achieving AUROCs from 0.75 (Apollo) to 0.90 (ESMCBA), with most predictors clustering tightly around 0.74–0.90. These high AUROCs demonstrate robust recognition of known canon- ical binding motifs by current sequence-based methods, aligning well with their training data.

Performance on Random-Sampled Peptides

To evaluate predictor specificity, we tested their ability to discriminate randomly sampled peptides from experimen- tally validated peptides with strong binding. Most predictors correctly assigned low binding scores to random peptides, achieving AUROCs from 0.88–1.00. These results confirm that predictors are robustly specific, effectively distinguish- ing random peptides from biologically plausible sequences.

5

0.50.60.70.80.9Jensen-Shannon distance to

IEDB AA-frequency background12345ESCMBA log10 IC50 predictionClassAnchor-preservedPLDDT

0.80Global sequence sampleGeneration of structure-guided pMHC-I libraries using Diffusion Models

Figure 4. ROC curves and AUROC values for seven binding affinity predictors across four peptide evaluation classes: experimentally validated binders, permutation-test controls, random-sampled negatives, and structure-guided diffusion designs.

les. This likely reflects the well-documented tendency of diffusion-based generative models to rigidify local struc- tures by favoring proline, a behavior also noted by the authors of RFdiffusion in other contexts. While proline enrichment may provide stabilizing biophysical effects in some cases, its consistent appearance across unrelated alle- les suggests that it can also represent a technical artifact of the generative process rather than a true biological signal. Second, our positional variance analysis revealed additional biases in amino-acid usage that were relatively uniform across alleles. Such across-allele uniformity may indicate model-driven design constraints that override allele-specific preferences, highlighting the importance of correcting for background biases when interpreting sequence logos or en- richment statistics. Third, although our approach success- fully recapitulates canonical anchors and these residues were associated with systematically higher structural confidence, structural proxies remain imperfect surrogates for physical

binding. The iPTM score, which measures AlphaFold2’s confidence in interface packing, and the per-residue pLDDT metric are both useful correlates, but they cannot directly prove biochemical stability or immunogenicity. Finally, by design our approach expands into sequence space that lies outside the distribution of known epitopes. This novelty is a strength, as it enables exploration of under-sampled regions of the binding landscape, but it also means that our gener- ated peptides must ultimately be validated experimentally. Without functional testing, their true binding capacity and immunological relevance remain unknown.

Overall, our workflow and generated library provide both a benchmark for predictive models and a tool to uncover data- and model-driven biases. While our validation relied primarily on the unbiased EpiScan dataset, which is limited to four alleles, our framework is generalizable to a broader range of HLA types. Looking forward, incorporating TCR- binding predictions and extending experimental validation

6

0.00.20.40.60.81.0FPR0.00.20.40.60.81.0TPRValidated testedbinders vs non-bindersMHCflurry (AUC=0.81)NetMHCpan %Rank (AUC=0.86)ESMCBA log IC50 (AUC=0.90)HLAthena %Rank (AUC=0.84)Apollo inverse (AUC=0.75)MHC Nugget (AUC=0.87)MixMHCPred %Rank (AUC=0.83)0.00.20.40.60.81.0FPR0.00.20.40.60.81.0TPRValidated strongbinders vs ESM2 randomMHCflurry (AUC=0.99)NetMHCpan %Rank (AUC=1.00)ESMCBA log IC50 (AUC=1.00)HLAthena %Rank (AUC=1.00)Apollo inverse (AUC=0.88)MHC Nugget (AUC=1.00)MixMHCPred %Rank (AUC=0.99)0.00.20.40.60.81.0FPR0.00.20.40.60.81.0TPRAnchor-preservedvs ESM2 randomMHCflurry (AUC=0.88)NetMHCpan %Rank (AUC=0.93)ESMCBA log IC50 (AUC=0.89)HLAthena %Rank (AUC=0.93)Apollo inverse (AUC=0.71)MHC Nugget (AUC=0.90)MixMHCPred %Rank (AUC=0.89)0.00.20.40.60.81.0FPR0.00.20.40.60.81.0TPRDiffusion designsvs ESM2 randomMHCflurry (AUC=0.79)NetMHCpan %Rank (AUC=0.90)ESMCBA log IC50 (AUC=0.78)HLAthena %Rank (AUC=0.92)Apollo inverse (AUC=0.66)MHC Nugget (AUC=0.85)MixMHCPred %Rank (AUC=0.75)0.00.20.40.60.81.0FPR0.00.20.40.60.81.0TPRDiffusion designsvs BindersMHCflurry (AUC=0.05)NetMHCpan %Rank (AUC=0.03)ESMCBA log IC50 (AUC=0.03)HLAthena %Rank (AUC=0.14)Apollo inverse (AUC=0.19)MHC Nugget (AUC=0.04)MixMHCPred %Rank (AUC=0.04)0.00.20.40.60.81.0FPR0.00.20.40.60.81.0TPRDiffusion designsvs Anchor-preservedMHCflurry (AUC=0.29)NetMHCpan %Rank (AUC=0.27)ESMCBA log IC50 (AUC=0.27)HLAthena %Rank (AUC=0.40)Apollo inverse (AUC=0.42)MHC Nugget (AUC=0.30)MixMHCPred %Rank (AUC=0.24)Generation of structure-guided pMHC-I libraries using Diffusion Models

across additional alleles will broaden the relevance of this methodology for comprehensive immunotherapy design. In doing so, our approach establishes a path toward expand- ing the epitope landscape beyond current data limitations while maintaining biological plausibility through structural constraints.

5. Data and Code Availability

Data and code for all the analyses can be found in the Github repository: https://github.com/sermare/struct-mhc-dev.

6. Acknowledgements

We thank Dr. Peter Bruno for valuable comments and help with the EpiScan analysis.

References

Anjanappa, R., Garcia-Alai, M., Kopicki, J.-D., Lock- hauserb¨aumer, J., Aboelmagd, M., Hinrichs, J., Nem- tanu, I. M., Uetrecht, C., Zacharias, M., Springer, Structures of peptide-free and S., and Meijers, R. partially loaded mhc class i molecules reveal mecha- nisms of peptide selection. Nature Communications, 11(1):1314, 2020. ISSN 2041-1723. doi: 10.1038/ s41467-020-14862-4. URL https://doi.org/10. 1038/s41467-020-14862-4.

Elledge, S. J. High-throughput, targeted mhc class i im- munopeptidomics using a functional genetics screening platform. Nature Biotechnology, 41(7):980–992, July 2023. doi: 10.1038/s41587-022-01566-x. URL https: //doi.org/10.1038/s41587-022-01566-x.

Chaplin, D. D.

Overview of

Journal of Allergy and Clinical 125(2, Supplement 2):S3–S23,

the immune re- Im- sponse. munology, 2010. 10.1016/j.jaci.2009.12. doi: ISSN 0091-6749. 980. URL https://www.sciencedirect.com/ science/article/pii/S0091674909028371.

Chaurasia, P., Nguyen, T. H., Rowntree, L. C., Juno, J. A., Wheatley, A. K., Kent, S. J., Kedzierska, K., Rossjohn, J., and Petersen, J. Structural basis of biased t cell re- ceptor recognition of an immunodominant hla-a2 epi- tope of the sars-cov-2 spike protein. Journal of Bio- logical Chemistry, 297(3):101065, 2021. ISSN 0021- 9258. doi: 10.1016/j.jbc.2021.101065. URL https: //doi.org/10.1016/j.jbc.2021.101065.

Dauparas, J., Anishchenko, I., Bennett, N., Bai, H., Ragotte, R., Milles, L., Wicky, B., Courbet, A., de Haas, R., Bethel, N., Leung, P., Huddy, T., Pellock, S., Tischer, D., Chan, F., Koepnick, B., Nguyen, H., Kang, A., Sankaran, B., Bera, A., King, N., and Baker, D. Robust deep learning–based protein sequence design using proteinmpnn. Science, 378 (6615):49–56, 2022. doi: 10.1126/science.add2187.

Bassani-Sternberg, M., Chong, C., Guillaume, P., Solleder, M., Pak, H.-Y., Gannon, P. O., Kandalaft, L. E., Coukos, G., and Gfeller, D. Deciphering HLA-I motifs across HLA peptidomes improves neo-antigen predictions and identifies allostery regulating HLA specificity. PLoS Computational Biology, 13(8):e1005725, 2017. doi: 10. 1371/journal.pcbi.1005725.

Dincer, A. B., Lu, Y., Schweppe, D. K., Oh, S., and No- ble, W. S. Reducing peptide sequence bias in quan- titative mass spectrometry data with machine learn- ing. Journal of Proteome Research, 21(7):1771–1782, 2022. ISSN 1535-3893. doi: 10.1021/acs.jproteome. 2c00211. URL https://doi.org/10.1021/acs. jproteome.2c00211.

Berman, H., Henrick, K., and Nakamura, H. An- Na- nouncing the worldwide protein data bank. ture Structural Biology, 10:980, 2003. 10. 1038/nsb1203-980. URL https://doi.org/10. 1038/nsb1203-980. Accessed via https://www. wwpdb.org.

doi:

Blevins, S. J., Pierce, B. G., Singh, N. K., Riley, T. P., Wang, Y., Spear, T. T., Nishimura, M. I., Weng, Z., and Baker, B. M. How structural adaptability exists alongside hla-a2 bias in the human alpha-beta tcr reper- toire. Proceedings of the National Academy of Sci- ences, 113(9):E1276–E1285, 2016. doi: 10.1073/pnas. 1522069113. URL https://www.pnas.org/doi/ abs/10.1073/pnas.1522069113.

Bruno, P. M., Timms, R. T., Abdelfattah, N. S., Leng, Y., Lelis, F. J. N., Wesemann, D. R., Yu, X. G., and

Hilf, N., Kuttruff-Coqui, S., Frenzel, K., Bukur, V., Ste- vanovi´c, S., Gouttefangeas, C., Platten, M., Tabatabai, G., Dutoit, V., van der Burg, S. H., thor Straten, P., Mart´ınez-Ricarte, F., Ponsati, B., Okada, H., Lassen, U., Admon, A., Ottensmeier, C. H., Ulges, A., Kre- iter, S., von Deimling, A., Skardelly, M., Migliorini, D., Kroep, J. R., Idorn, M., Rodon, J., Pir´o, J., Poulsen, H. S., Shraibman, B., McCann, K., Mendrzyk, R., L¨ower, M., Stieglbauer, M., Britten, C. M., Capper, D., Wel- ters, M. J. P., Sahuquillo, J., Kiesel, K., Derhovanes- sian, E., Rusch, E., Bunse, L., Song, C., Heesch, S., Wagner, C., Kemmer-Br¨uck, A., Ludwig, J., Castle, J. C., Schoor, O., Tadmor, A. D., Green, E., Fritsche, J., Meyer, M., Pawlowski, N., Dorner, S., Hoffgaard, F., R¨ossler, B., Maurer, D., Weinschenk, T., Reinhardt, C., Huber, C., Rammensee, H.-G., Singh-Jasuja, H., Sahin, U., Dietrich, P.-Y., and Wick, W. Actively per- sonalized vaccination trial for newly diagnosed glioblas-

7

Generation of structure-guided pMHC-I libraries using Diffusion Models

toma. Nature, 565(7738):240–245, 2019. ISSN 1476- 4687. doi: 10.1038/s41586-018-0810-y. URL https: //doi.org/10.1038/s41586-018-0810-y.

class i epitope prediction across most of the human popu- lation. Nature Biotechnology, 38(2):199–209, 2020. doi: 10.1038/s41587-019-0322-9.

Li, L., Santarsiero, B. D., and Bouvier, M. Structure of the adenovirus type 4 (species e) e3-19k/hla-a2 com- plex reveals species-specific features in mhc class i recognition. Journal of Immunology, 197(4):1399–1407, 2016. doi: 10.4049/jimmunol.1600541. URL https: //doi.org/10.4049/jimmunol.1600541.

Lin, Z., Akin, H., Rao, R., Hie, B., Zhu, Z., Lu, W., Smetanin, N., Verkuil, R., Kabeli, O., Shmueli, Y., dos Santos Costa, A., Fazel-Zarandi, M., Sercu, T., Can- dido, S., and Rives, A. Evolutionary-scale prediction of atomic-level protein structure with a language model. Science, 379(6637):1123–1130, 2023. doi: 10.1126/ science.ade2574. URL https://www.science. org/doi/abs/10.1126/science.ade2574.

Machaca, V., Goyzueta, V., Cruz, M. G., Sejje, E., Pilco, L. M., L´opez, J., and T´upac, Y. Transformers meets neoantigen detection: a systematic literature review. Jour- nal of Integrative Bioinformatics, 21(2):20230043, 2024. doi: 10.1515/jib-2023-0043. URL https://doi. org/10.1515/jib-2023-0043.

Mallick, P., Schirle, M., Chen, S. S., Flory, M. R., Lee, H., Martin, D., Ranish, J., Raught, B., Schmitt, R., Werner, T., Kuster, B., and Aebersold, R. Computa- tional prediction of proteotypic peptides for quantita- tive proteomics. Nature Biotechnology, 25(1):125–131, 2007. ISSN 1546-1696. doi: 10.1038/nbt1275. URL https://doi.org/10.1038/nbt1275.

Mares, S. E., Weinberger, A. E., and Ioannidis, N. M. Continued domain-specific pre-training of protein lan- guage models for pmhc-i binding prediction. 2025. URL https://arxiv.org/abs/2507.13077.

McInnes, L., Healy, J., and Melville, J. Umap: Uniform manifold approximation and projection for dimension reduction. arXiv preprint arXiv:1802.03426, 2018.

O’Donnell, T., Rubinsteyn, A., and Laserson, U. Mhcflurry Improved pan-allele prediction of mhc class i- 2.0: presented peptides by incorporating antigen processing. Cell Systems, 11(1):42–48, 2020. doi: 10.1016/j.cels. 2020.06.009.

Sarkizova, S., Klaeger, S., Le, P. M., Li, L. W., Oliveira, G., Keshishian, H., Hartigan, C. R., Zhang, W., Braun, D. A., Ligon, K. L., Bachireddy, P., Zervantonakis, I. K., Rosenbluth, J. M., Ouspenskaia, T., Law, T., Justesen, S., Stevens, J., Lane, W. J., Eisenhaure, T., Zhang, G. L., Clauser, K. R., Hacohen, N., Carr, S. A., Wu, C. J., and Keskin, D. B. A large peptidome dataset improves hla

Saxena, M., Marron, T. U., Kodysh, J., Finnigan, Jr, J. P., Onkar, S., Kaminska, A., Tuballes, K., Guo, R., Sabado, R. L., Meseck, M., O’Donnell, T. J., Sebra, R. P., Parekh, S., Galsky, M. D., Blasquez, A., Gimenez, G., Bicak, M., Bozkus, C. C., Delbeau-Zagelbaum, D., Rodriguez, D., Acuna-Villaorduna, A., Misiukiewicz, K. J., Posner, M. R., Miles, B. A., Irie, H. Y., Tiersten, A., Doroshow, D. B., Wolf, A., Mandeli, J., Brody, R., Salazar, A. M., Gnjatic, S., Hammerbacher, J., Schadt, E., Friedlander, P., Rubinsteyn, A., and Bhardwaj, N. Pgv001, a multi- peptide personalized neoantigen vaccine platform: Phase i study in patients with solid and hematologic malignan- cies in the adjuvant setting. Cancer Discovery, 15(5):930– 947, May 2025. doi: 10.1158/2159-8290.CD-24-0934. URL https://doi.org/10.1158/2159-8290. CD-24-0934.

Shao, X. M., Bhattacharya, R., Huang, J., Sivakumar, I. K. A., Tokheim, C., Zheng, L., Hirsch, D., Kaminow, B., Omdahl, A., Bonsack, M., Riemer, A. B., Velculescu, V. E., Anagnostou, V., Pagel, K. A., and Karchin, R. High-throughput prediction of MHC class i and class ii neoantigens with MHCnuggets. Cancer Immunology Research, 8(3):396–408, 2020. doi: 10.1158/2326-6066. CIR-19-0464.

Thrift, W. J., Lounsbury, N. W., Broadwell, Q., Heidersbach, A., Freund, E., Abdolazimi, Y., Phung, Q. T., Chen, J., Capietto, A.-H., Tong, A.-J., Rose, C. M., Blanchette, C., Lill, J. R., Haley, B., Delamarre, L., Bourgon, R., Liu, K., and Jhunjhunwala, S. Towards designing improved cancer immunotherapy targets with a peptide-mhc-i presentation model, hlapollo. Nature Communications, 15(1):10752, 2024. doi: 10.1038/s41467-024-54887-7.

Vita, R., Blazeska, N., Marrama, D., Members, J., Greenbaum,

I. J., C. T., Duesing, S., Bennett, De Almeida Mendes, M., Mahita, J., Wheeler, D. K., Cantrell, J. R., Overton, J. A., Natale, D. A., Sette, A., and Peters, B. The immune epitope database (iedb): 2024 update. Nucleic Acids Research, 53(D1):D436–D443, 2025. doi: 10.1093/nar/gkae1092.

Walz, S., Stickel, J. S., Kowalewski, D. J., Schuster, H., Weisel, K., Backert, L., Kahn, S., Nelde, A., Stroh, T., Handel, M., Kohlbacher, O., Kanz, L., Salih, H. R., Rammensee, H.-G., and Stevanovi´c, S. The antigenic landscape of multiple myeloma: mass spectrometry (re)defines targets for t-cell–based immunotherapy. Blood, 126(10):1203–1213, September 2015. ISSN 0006-4971. doi: 10.1182/blood-2015-04-640532. URL https:// doi.org/10.1182/blood-2015-04-640532.

8

Generation of structure-guided pMHC-I libraries using Diffusion Models

Watson, J., Juergens, D., Bennett, N., Trippe, B., Yim, J., Eisenach, H., Ahern, W., Borst, A., Ragotte, R., Milles, L., Wicky, B., Hanikel, N., Pellock, S., Courbet, A., Shef- fler, W., Wang, J., Venkatesh, P., Sappington, I., Tor- res, S., Raghavan, A., Chow, C., Carter, L., and Baker, D. De novo design of protein structure and function with rfdiffusion. Nature, 620:1089–1100, 2023. doi: 10.1038/s41586-023-06415-8.

Yewdell, J. W., Reits, E., and Neefjes, J. Making sense of mass destruction: quantitating MHC class I antigen presentation. Nature Reviews Immunology, 3(12):952– 961, 2003. doi: 10.1038/nri1250.

9

Generation of structure-guided pMHC-I libraries using Diffusion Models

A. Supplemental Tables

HLA Allele A0201

A0206 A0207 A2 A2402 A6 B1301 B1501 B1502 B1801 B2705 B2706 B3501 B3503 B3505 B3508

B4001 B4403 B4405 B5301 B5701 B5703 B5801 B5803 B8 C1202 C1203 N0101

# Structures PDB IDs

15

1 1 6 7 1 1 5 11 4 7 1 7 1 1 13

1 2 2 2 3 2 2 1 3 1 1 1

7KGP, 7KGQ, 7LG2, 7MJ9, 7MKB, 7MJ6, 3TO2, 7KGO, 7KGS, 7MJ8, 7LG3, 7MJ7, 7KGT, 7SA2, 3OXS 3OXR 3OXS 6UJQ, 6O4Z, 6O4Y, 6UJO, 6O51, 6O53 7JYW, 7EJN, 8SBK, 7EJL, 7JYV, 7EJM, 8HN4 4HX1 7YG3 6UZS, 7XF3, 6VB3, 6UZQ, 6UZP 6VB6, 6VIU, 6VB7, 6UZM, 6UZO, 6VB1, 6UZN, 6VB0, 6VB4, 6VB2, 6VB5 8ROP, 8RNH, 8ROO, 8RNG 6Y28, 6VQE, 6VQD, 6VQ2, 6VPZ, 6Y2A, 6Y26 5DEG 8EMK, 8EMF, 7SIG, 8EMG, 8EMI, 8EMJ, 4PRA 7SIH 7SIF 4PRD, 3VFP, 3VFR, 3VFN, 3VFO, 3VFU, 7KGO, 3VFS, 3VFM, 3VFT, 4PRE, 3VFW, 3VFV, 4PRB 6IEX 3KPN, 3KPO 6MTL, 1SYV 7R7W, 7R7V 6BXQ, 7R7Y, 6V2O 5VVP, 5VWD 7X00, 7WZZ 5VWF 8E8I, 8EC5, 8E13 9L48 9L49 6K7T

Table 1. HLA alleles with associated PDB structures

B. Supplemental Figures

10

Generation of structure-guided pMHC-I libraries using Diffusion Models

Figure S1. Jensen-Shannon distance matrix between 9-mer PWMs extracted from high-confidence (pLDDT ≥ 0.7) from the structure- guided generated peptides.

11

Generation of structure-guided pMHC-I libraries using Diffusion Models

Figure S2. Amino acid frequencies across positions in 9-mer structure-guided peptides from 27 alleles.

12

123456789ACDEFGHIKLMNPQRSTVWY0.000.050.100.150.200.250.300.350.40Percentage of sequencesGeneration of structure-guided pMHC-I libraries using Diffusion Models

Figure S3. EpiScan results for HLA-A*02:01.

Figure S4. Results from this study for HLA-A*02:01.

13

CMDSATEVNPGWYFQILHKR0246810Fold enrichment(EpiScan high / MS)Global (all positions)123456789Position0246810Fold enrichment (obs / bg)Enrichment for Valine (V)EpiScan highMS123456789Position02468Enrichment for Leucine (L)EpiScan highMSHLA-A0201 Enrichment (9-mers) PMATSCVWFHEGDLQRINYK012345Fold enrichment(Generated (this paper) / MS)Global (all positions)123456789Position0246Fold enrichment (obs / bg)Enrichment for Valine (V)Generated (this paper)MS123456789Position02468Enrichment for Leucine (L)Generated (this paper)MSHLA-A0201 Enrichment (9-mers) Generation of structure-guided pMHC-I libraries using Diffusion Models

Figure S5. EpiScan results for HLA-B*57:01.

Figure S6. Results from this study for HLA-B*57:01.

14

CMDSAGKEWLNTYHPIQVFR0246Fold enrichment(EpiScan high / MS)Global (all positions)123456789Position01020304050Fold enrichment (obs / bg)Enrichment for Tryptophan (W)EpiScan highMS123456789Position0123456Enrichment for Threonine (T)EpiScan highMSHLA-B5701 Enrichment (9-mers) MCPGADRLYSFQEVHTINWK0123Fold enrichment(All Generated (this paper) / MS)Global (all positions)123456789Position01020304050Fold enrichment (obs / bg)Enrichment for Tryptophan (W)All Generated (this paper)MS123456789Position0123456Enrichment for Threonine (T)All Generated (this paper)MSHLA-B5701 Enrichment (9-mers) Generation of structure-guided pMHC-I libraries using Diffusion Models

Figure S7. Sequence logos of 9-mer peptides grouped by allele, normalized against positional background frequencies. The height of each letter reflects relative information content.

15

12345678900.511.52A0201 | N=128612345678900.511.52A0206 | N=14312345678900.511.52A0207 | N=10112345678900.511.52A2402 | N=81112345678900.511.52B5701 | N=4712345678900.511.52B1502 | N=51212345678900.511.52B2705 | N=8612345678900.511.52B5703 | N=8612345678900.511.52C1203 | N=33Generation of structure-guided pMHC-I libraries using Diffusion Models

Figure S8. UMAP visualization of ESMCBA embeddings for HLA-A*02:01 peptides across classes and scoring metrics. The first row shows the key peptide categories for sequence space analysis: Experimental IC50 Measurement (experimentally validated epitopes), Anchor-Preserved Mutagenesis Baseline (control peptides with conserved anchor residues but randomized non-anchor positions), and Global Sequence Sampling Control (random peptides generated by autoregressive ESM2 sampling).

16

−2024681012UMAP 1024681012UMAP 2Experimental IC₅₀ Measurement−2024681012UMAP 1024681012UMAP 2Anchor-Preserved Mutagenesis Baseline−2024681012UMAP 1024681012UMAP 2Global Sequence Sampling Control−2024681012UMAP 1024681012UMAP 2HLA Athena MSi (Sarkizova et al. 2019)−2024681012UMAP 1024681012UMAP 2HLApollo (Thrift et al. 2024)−2024681012UMAP 1024681012UMAP 2ESMCBA log₁₀ IC₅₀ Prediction−2024681012UMAP 1024681012UMAP 2AF2 pLDDT−2024681012UMAP 1024681012UMAP 2ProteinMPNN Score−2024681012UMAP 1024681012UMAP 2AF2 iPTM Score0123456Experimental IC₅₀ Measurement0.00.51.0Anchor-Preserved Mutagenesis Baseline0.00.51.0Global Sequence Sampling Control0.20.40.60.8HLA Athena MSi (Sarkizova et al. 2019)−40−30−20−10010HLApollo (Thrift et al. 2024)12345ESMCBA log₁₀ IC₅₀ Prediction0.20.30.40.50.60.70.80.9AF2 pLDDT0.751.001.251.501.752.002.252.50ProteinMPNN Score0.10.20.30.40.50.60.70.80.9AF2 iPTM Score