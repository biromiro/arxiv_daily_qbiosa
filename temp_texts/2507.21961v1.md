#

 # Introduction—Many complex dynamical systems ex- hibit metastability, a phenomenon wherein the system successively resides in some states for long periods of time. Understanding how such rare transitions take place is a fundamental problem across multiple disci- plines, from chemistry and physics to biology and ma- terial science. In biomolecular systems, rare transitions are often associated with conformational changes, chem- ical reactions, or ligand binding processes, all essen- tial to biological function [1–4]. More generally, similar metastable behavior is also seen in other complex abi- ological systems, such as magnetic-domain switching in ferromagnetic materials [5], glassy systems [6], or climate dynamics [7]. However, the properties of the underly- ing statistical-physical description of rare transitions be- tween metastable states share common traits for such systems of very different nature.

Central to understanding the mechanism underlying the function of biomolecular systems is a characteriza- tion of the different routes, or transition pathways, taken by the system when interconverting between metastable states. For instance, the insight gained from the knowl- edge of the relevant transition pathways can guide drug design, protein engineering, or the optimization of cat- alytic processes. A number of challenges, however, stand in the way of achieving this objective. In particular, the fact that the transitions at hand may be extremely rare makes their direct observation through simple brute-force

simulations nearly impossible. From a practical stand- point, simulating these processes cannot be done suc- cessfully without some form of enhanced-sampling strat- egy [8]. An additional challenge is the curse of dimen- sionality due to the large number of degrees of freedom at play. Usually, one expects that the necessary and suf- ficient information to understand and predict rare tran- sitions is included within a subspace of lower dimension. Most practical computational strategies to tackle slow processes are designed to enhance the sampling of the as- sociated degrees of freedom by leaning on the knowledge of a subspace of selected collective variables (CVs) [9]. In this regard, information about the transition path- ways between the metastable states within this subspace of CVs can be exploited to enhance sampling in a path- specific manner [10]. On the basis of these observations, the overarching goal is to design an effective approach for discovering the relevant set of CVs alongside the most likely set of transition pathways that underlie the slow processes of interest.

A given transition pathway connecting two long-lived metastable states A and B can be parametrically rep- resented as a reaction tube of a given width centered on a curvilinear line embedded in the subspace of the CVs [11]. These formal constructs appear also in the context of the finite-temperature string method in CV space [12], the string method in collective variables yield- ing the minimum free energy pathway (MFEP) [13], and

5 2 0 2

l u J

9 2

] h p - p m o c . s c i s y h p [

1 v 1 6 9 1 2 . 7 0 5 2 : v i X r a













the string method with swarms-of-trajectories supplying a zero-drift pathway (ZDP) [14]. For completeness, it should be mentioned that the MFEP can be inferred from a complete mapping of the free-energy landscape [15]. In the last decade, the development of transition path the- ory (TPT) has established a theoretical framework to greatly expand the concept of transition pathways. One of the central ingredients of TPT is the concept of for- ward committor probability, q, defined as the probability that a trajectory initiated at some configuration, z0, will ultimately reach state B before state A [16], i.e.,

q(z0) = P

τB(z0) < τA(z0)

,

(1)

(cid:1)

}

S

Ω

⊂

(cid:0) ∈

t {

z(t

z0) |

is the hitting time of S

where τS = inf z0) being the trajectory with initial condition z0, with z(t | point at time t from an initial condition z0. Importantly, knowledge of the committor, q, enables a formal expres- sion of all reactive events from A to B, providing key information for the definition and discovery of dynami- cally meaningful transition pathways. In this sense, the function q can serve as the best surrogate for the reac- tion coordinate (RC) in the subspace of CVs [17]. The committor can also be expressed in terms of a functional minimization of the steady-state reactive flux, JAB[q; τ ], which can be written in terms of a time-correlation func- tion [18], i.e.,

JAB[q; τ ] =

C[q; τ ] τ

,

C[q; τ ] =

1 2

(q(τ )

−

q(0))2

(2)

(cid:11)

≡

(cid:10) where τ is the time lag that guarantees a Markovian de- scription of the dynamics, and q(t) q(z(t)) is the value taken by the committor at time t of the trajectory. Said differently, q, as defined in Eq. (1), is the function that minimizes JAB[q; τ ] for a given τ . These considerations together with the variational principle led to the concept of committor-consistent string (CCS) [19]. The latter is generally not coincident with the MFEP or the ZDP. The theoretical framework from TPT, when combined with the power of artificial neural networks (ANN), allows us to develop tools designed to learn the committor proba- bility from dynamical information. An example of these tools is provided by the variational committor networks (VCNs) [20], based on Eq. (2).

One of the main features of the committor function is that the different transition mechanisms can be found in the vicinity of the so-called separatrix, defined as the isocommittor hyperplane at q = 1/2. Hence, this hyper- plane contains all configurations that have equal proba- bility of evolving towards A or B. In the Markovian dif- fusive limit, the tangent to the curvilinear CCS transition pathway should follow the local gradient of the function q in the neighborhood of the separatrix [18, 21]. This idea also aligns with recent insights from information thermo- dynamics of transition-state ensembles the optimal RC

2

should follow the gradient of the committor [22]. These fundamental observations form the cornerstone of this work.

Both the determination of the optimal pathways and learning of the committor depend on prior knowledge of the underlying dynamics. This requirement can be addressed via iterative approaches, whereby initial sam- pling is necessary to prime the optimization workflow. Improvement of the sampling along the model RC lever- ages the knowledge of the inferred committor. An il- lustration of this feedback loop is furnished in Ref. [23], where the committor is learned concomitantly with its corresponding CCS. However, in complex molecular sys- tems, there is no guarantee that the transition at hand can be modeled by a single CCS. In reality, multiple rel- evant pathways often form the transition-path ensem- ble. This plurality of routes makes the full character- ization of the underlying reaction mechanisms appre- ciably more intricate. In this Letter, we introduce a methodology geared towards the discovery of multiple committor-guided transition pathways, or reaction tubes. This methodology consists of an iterative approach to predict and refine the committor based on multiple sim- ulations performed along the pathways determined self- consistently. In addition, we show that the transition kinetics can be accurately modeled from the converged ensemble of pathways.

1

−

{

×

×

⊆

zi}

Rn2 ,

Methodology—Let us assume that the pathway can be parameterized in terms of a discretized string of m im- m Tn1 ages in the CV subspace Ω i=0 , where Tn1 Rn2 is the total CV subspace for, in general, n1 periodic and n2 nonperiodic CVs. This discretized string will be henceforth referred to as string pathway. Under these premises, we introduce an iterative loop designed to reveal multiple transition pathways, drawing inspira- tion from feedback-based methodologies commonly em- ployed to estimate the committor probability. The in- sight gained from each iteration is leveraged to enhance sampling, thereby refining progressively the results until convergence is achieved. This process is outlined in the following workflow:

(cid:101)

(a) Generate biased sampling based on an initial guess

of the CVs.

(b) Use the VCN to learn the committor function over a predefined set of CVs, z, in the Ω subspace, not necessarily identical to that of the previous step.

∈

≪

[1/2

(c) Identify all states for which the committor value ε, 1/2 + ε], with lies within the interval q 2ε 1. From these states, propagate in Ω deter- ministic string pathways along the gradient of the ∇zq, backward and forward, so as to committor, reach state A and state B, respectively. Ultimately, the generated half pathways are mended together to form a continuous one.

−

3

FIG. 1. (a-e) Schematic representation of the steps of our iterative approach: (a) Initial biased sampling, (b) learn the committor, (c) forward and backward shooting of strings from the separatrix, (d) clustering of the gradient-guided strings and calculating the average strings, (e) biased sampling along the new pathways. (f) Converged CCSs and learned committor values q corresponding to the two transition pathways of the triple-well potential. Strings from the iterations are also included, with a color gradient indicating the progression of the iterative procedure.

(d) Cluster the resulting pathways and compute a weighted average for each cluster to obtain repre- sentative string pathways.

(e) Perform biased simulations along CVs defined by each representative string pathway, e.g., the dis- cretized path-collective variable (PCV) [10]. If con- vergence is achieved, terminate the workflow. Oth- erwise, return to step (b).

avoiding artificial splitting and revealing the actual reac- tion tubes for the molecular process at hand. In practice, this procedure described schematically in Fig. 2(a–b), eliminates the risk of redundant sampling of effectively identical reaction tubes.

The curvilinear strings of images used in the enhanced sampling PCV calculations serve as proxies to explore the reaction tubes delineating the transition pathways associated with the different reaction mechanisms [10].

The various steps of the methodology are gathered in Fig. 1(a–e). It is noteworthy that in order to guarantee the smoothness of ∇zq, the original VCN introduced in Ref. [20] has been slightly tailored, as described in the Supplemental Material (SM). As stated previously, the objective of the iterative procedure is to progressively re- fine the learned committor function, thereby improving the identification of the transition pathways. In the spirit of Refs. [19] and [23], the string pathways are defined to be perpendicular to the separatrix hyperplane, and, con- sequently, aligned with the gradient of the committor. By extension, we assume that these pathways strictly follow ∇zq (forward and backward) at each point between the separatrix and the basins. This construction addresses the degeneracy problem often encountered when charac- terizing transition pathways in complex molecular pro- cesses [24, 25]. Specifically, to prevent double-counting of transitions occurring at different spatial locations, we implement a post-processing step during the determina- tion of the representative string pathways. Specifically, in step (d) of the workflow, we analyze the exchange be- tween different averaged strings by performing a Voronoi tessellation of Ω, wherein the string images are the cen- troids of each cell. Cells between which significant ex- change is measured are merged into a single tile, thus

Consequently, small changes in the string pathways between successive iterations are expected to not sig- nificantly affect sampling. It follows that the conver- gence criteria should rely on the quality and consistency of sampling rather than on the precise shape of the string pathways. We quantify the consistency of sam- pling using the Kullback–Leibler divergence (KLD), , D based on the spatial distribution of samples throughout Ω. After computing the representative discretized string pathways—–applying the merging criteria based on ex- changes between Voronoi cells—–we obtain a set of ns ns images, zi} i=1. These images define a partition of Ω { ns into Voronoi cells, i=1, where each cell is given by , with d denot- d(z, d(z, Ω Ci = (cid:101) ∈ ing a distance. In practice, this distance coincides with the Euclidean one, taking into account periodicity wher- (cid:101) ever needed. From this partition, we infer the sampling probability for each cell Ci at iteration k, referred to as p(k)(Ci), and compare it to the probability from the pre- vious iteration, p(k 1)(Ci). Next, the KLD at the k-th iteration can be defined as,

Ci} ≤

= i }

{ zi)

j ∀

zj)

(cid:101)

z

{

−

|

(k) =

D

ns

i=1 (cid:88)

p(k)(Ci) ln

p(k)(Ci) 1)(Ci) p(k

−

.

(cid:19)

(cid:18)

(3)

If the iterative process has converged, the simulations

(f)(a)(e)(b)(d)(c)...qznz1̸ D

performed under identical conditions should yield con- sistent spatial sampling probabilities. Consequently, one (k) to decrease progressively at each iteration k. expects Similar KLD measures have been employed previously to detect differences in spatial distributions in a variety of contexts [26, 27]. Once convergence of the sampling has been established, our ultimate aim is to compute the rate constant for the transition at hand by recovering the un- biased flux, JAB. To achieve this goal, we generate a se- ries of unbiased trajectories from random configurations taken from n separate PCV tra- corresponding to jectories. The time-correlation function of Eq. (2) can be calculated as a weighted average over initial conditions, zi, distributed uniformly in the CV subspace, Ω, of these unbiased trajectories [28],

zi}

{

C[q; t] = (cid:88)

i

R(zi) czi[q; t]

R(zj)

,

(4)

j (cid:88) where R(zi) is a reweighting factor for point zi randomly picked from the totality of the biased PCV data, and used as the initial condition to generate a short unbiased mt− trajectory of mt steps, j=0 , with time step z(j∆t { ∆t, which is then used to calculate the conditional time- correlation function of the learned committor at time t,

zi) } |

1

czi[q; t] =

1 mt

1 mt−

j=0 (cid:16) (cid:88)

q

z(t + j∆t |

zi)

−

q

z(j∆t

zi) |

(cid:0)

(cid:1)

(cid:0)

The reweighting factor for point zi is defined as,

R(zi) =





j (cid:88)

nj e−

β(wj (zi)

Fj )

−

1

−

,





where β = 1/kBT . Eq. (6) is determined from a bin- less version of the weighted histogram analysis method (WHAM) [29], leveraging the data accrued in the n sep- arate PCV calculations,

Fj =

1 β

−

ln

dz e−

βwj (z)

(cid:90)

ρ(z) ⟨

, ⟩

ρ(z)

nj⟨

(j) b ⟩

(7)

ρ(z) ⟩

⟨

= (cid:88)

j nke−

β(wk(z)

,

Fk)

−

(cid:88)k



 

where nj and wj(z) are the total number of data points and the converged biasing potential (see SM) from the j-th PCV calculation, respectively, and Fj is the free- energy offset determined in a self-consistent fashion by the j-th PCV calculation via the WHAM equations from (generated by the j-th ρ(z) the biased distribution, ⟩

(j) b

⟨

2

.

(cid:1)(cid:17)

(5)

(6)

4

⟩

PCV calculation). Here, formally stands for the ρ(z) ⟨ complete unbiased equilibrium distribution in the CV subspace, Ω, although it is not explicitly generated in the current bin-less treatment.For more details about the derivation of this methodology, the reader is referred to the SM. Finally, recalling Eq. (2), the steady-state re- dC[q; t]/dt, active flux can be recovered as JAB = lim τq t →

where τq corresponds to a relaxation time, allowing the rate constant to be estimated from kAB = JAB/pA, where pA = P (z A) is the probability to be in the reactant basin A approximated from event counting.

∈

Results—As a first

illustration, we assessed our methodology with a toy model—the two-dimensional triple-well potential [30, 31] (see Fig. 1f). Through the aforementioned iterative process, starting from an ini- tial PCV sampling at 300 K along a guess straight path connecting the two main basins, we were able to iden- tify the two expected string pathways: An upper one crossing a local minimum, and a lower one, favored at higher temperature, requiring a higher energy barrier to be overcome [23].

Next, we investigated a simple molecular system, N – acetyl–N ′–methylalanylamide (NANMA)—often called dialanine or alanine dipeptide—in vacuum. The isomer- ization of NANMA between the C7eq and C7ax confor- mations (see Fig. 2c–d) has been extensively used as a benchmark to validate new methodologies aimed at sam- pling rare events [32–34]. In this work, we chose the backbone dihedral angles ϕ, ψ, θ and ω as the CVs (see Fig. 2c), in line with previous studies of this sys- tem [20, 23, 35, 36]. Most notably, we were able to ob- tain the same set of CVs using a statistical analysis. To do so, we started enumerating all possible dihedral an- gles of NANMA as CV candidates. Then, we calculated the Pearson correlation matrix and pruned the redundant CVs. Among each group of correlated dihedral angles, only the one with the highest importance—defined as the sum of the correlation coefficients involving the CV at hand—was kept (see Fig. 2h). Moreover, the nondimen- Sk, of the model with respect to the un- sional sensitivity, sk, with correlated k-th CV, defined as, S k si = Ω, can be computed ∂q(z)/∂zi|⟩z ∈ to further discriminate the relevant CVs by ranking their importance in the dynamics of the process. These results, while preliminary, are suggestive of a general framework for the definition of Ω. To prime the iterative process, we ran a simulation biasing the two RMSDs with re- spect to C7eq and C7ax. Our proposed approach was able to correctly identify all the relevant transition path- ways [10, 34, 37] (see Fig. 2e–g), while other similar data- driven committor-based schemes fail to achieve this ob- jective, managing to single out only one of the possible paths (corresponding to Path 1 in Fig 2e–g) [23, 35, 36]. To further appraise the ability of our methodology to handle multiple, alternate and interconnected pathways,

(zi) = si/ max

∂zi q(z)

Ω ≡ ⟨|

|⟩z ∈

⟨|

5

FIG. 2. (a-b) Schematic representation of the path merging to identify overlapping paths: (a) Exchange in the sampled trajectory between the Voronoi tiles defined by the string images, (b) new string images from weighted averages. (c-d) Rendered representation of NANMA in (c) the C7eq and (d) C7ax conformations. Carbon atoms are depicted in grey, hydrogen in white, oxygen in red, and nitrogen in blue. The dihedral angles, ϕ, ψ, θ, and ω, are highlighted in (c), while the labels of the heavy atoms are shown in (d). (e-g) Converged CCSs and learned committor, q, corresponding to the relevant isomerization pathways of NANMA, projected onto the (e) (ϕ, ψ), (f) (ϕ, θ), and (g) (ϕ, ω) subspaces. The reference free-energy landscape is shown as gray contour lines, with the values expressed in kcal/mol. (h) Right: Pearson correlation matrix between all the dihedral , of the model with respect to the CVs belonging to Ω, selected from angles of NANMA. Left: Nondimensional sensitivity, the correlation analysis.

S

−

−

−

70◦, 60◦) and state B defined by (

we tackled the challenging case of the isomerization of tri- alanine in vacuum, using (ϕ1, ϕ2, ϕ3) as the CVs [38, 39] (see Fig. 3a). To prime the iterative process, we ran a simulation biasing two RMSDs with respect to state A 70◦, defined by (60◦, 60◦, 70◦) (see Fig. 3b–c). The rugged free-energy land- scape underlying isomerization [40] suggests that tran- siting from A to B can occur through a variety of path- ways, passing through multiple intermediates. A previ- ous study showcased a computational strategy based on the string method with swarms of trajectories [14], from which the authors were able to obtain five relevant tran- sition pathways [39]. Our findings not only confirm the results of Chen et al., barring the slowest, less relevant path, but also bring to light a total of 21 different string pathways connecting A and B (see Fig. 3d,e, and Table S2 in the SM), thus rendering a complete picture of the conformational equilibrium dynamics.

As a final illustration, we considered the Diels–Alder reaction of ethylene with vinyl–acetylene, depicted in Fig. 4c. This reaction showcases the importance of the path-merging algorithm described above. The initial sampling was obtained by biasing along the d1 distance shown in Fig. 4c. In the first iteration of the workflow, two distinct pathways were determined (see Fig. 4a),

which were subsequently merged into a single string path- way (see Fig. 4b), leading to the formation of the product. This result aligns with the two-dimensional quantum- chemical free-energy landscape mapped for this reaction, suggestive that the two initial pathways were, in fact, alternative routes that pertain to the same very broad reaction tube.

D

The convergence of all calculations reported herein is as a func- assessed based on the progressive decrease of tion of the iteration, as detailed in the SM. At the end of each iterative process, short unbiased simulations were performed from a subset of configurations extracted from the PCV calculation of the last iteration. These short unbiased trajectories were then used to learn the final committor function, from which the rate constants, kAB, associated with the molecular processes of interest were estimated. The estimates reported in Table I correspond to a 99% confidence interval, and are consistent with val- ues reported using alternate methodologies. The detail of these computations can be found in the SM.

Conclusion—In this Letter, we have introduced a novel approach for the iterative discovery of committor-guided string pathways, used in turn to enhance the sampling of rare events. The key idea lies in the construction of string pathways that follow the gradient of the committor func-

C7eq(c)(e)(f)C7ax012416181412138(g)(b)(a)(h)(d)6

TABLE I. Transition rates kAB for the triple-well potential, NANMA and trialanine isomerization, and the Diels–Alder reaction.

System

Transition rate, kAB (ps−

1)

This work

Reference

Triple-well NANMA Trialanine Diels–Alder reaction

(1.450

± (3.0 (1.8 (2.3

0.010) 0.7) 0.4) 1.0)

± ± ±

× × × ×

10− 10− 10− 10−

2 6.44 6 1.34 5 3.62 4 1.03

10− 10− 10− 10−

2 [23] 5 [20] 5 [39] 3 [3]

× × × ×

framework allows the underlying dynamics of the molec- ular process at hand to be faithfully rendered. By clus- tering the ensemble of curvilinear lines determined in the Ω subspace of CVs, we identify the dominant transition pathways that characterize the process of interest. In sys- tems evolving on rugged free-energy landscapes—as often observed in high-dimensional biomolecular dynamics— multiple competing pathways may coexist. Our ap- proach resolves the inherent degeneracy associated with committor-based descriptions by leveraging the commit- tor directly as a CV, thereby enabling efficient sam- pling across all relevant pathways. Moreover, by merg- ing string pathways based on transitions between Voronoi cells in the Ω subspace, we recover the correct dynam- ical behavior and uncover overlapping reaction tubes. Our methodology is general—it is agnostic to the spe- cific means used to estimate the committor or to perform sampling, and is thus compatible with a broad range of simulation strategies aimed at exploring rare events. One remaining limitation lies in the definition of the Ω sub- space. As a possible route to address this limitation, we propose a preliminary framework for selecting meaningful CVs from a large pool of potential candidates based on the gradient of the committor. Finally, the identification of overlapping reaction tubes opens the door to further efficiency gains. In particular, decomposing string path- ways into unique segments and employing multiple-copy and replica-exchange strategies may help reduce redun- dant sampling in future implementations.

Acknowledgements—C.C. acknowledges the European Research Council (project 101097272 “MilliInMicro”), the Universit´e de Lorraine through its Lorraine Uni- versit´e d’Excellence initiative, the R´egion Grand-Est (project “Respire”), and the Agence Nationale de la Recherche under France 2030 (contract ANR-22-PEBB- 0009) for support in the context of the MAMABIO project (B-BEST PEPR). A.M. is sincerely thankful for the support provided by Universidad Polit´ecnica de Madrid through the “Programa Propio de Investigaci´on” grant EST-PDI-25-C0ON11-36-6WBGZ8, as well as the hospitality of the Universit´e de Lorraine during his stay.

FIG. 3. (a-c) Graphical representation of trialanine: (a) defi- nition of the ϕ1, ϕ2, and ϕ3 dihedral angles, (b) conformation A, and (c) conformation B. C atoms are depicted in grey, H in white, O in red, and N in blue. (d-c) Converged CCSs with (d) the reference free-energy landscape (grey isosurfaces corresponding to a free energy of 3.3 and 6.5 kcal/mol) and (e) the learned committor q and its isosurfaces corresponding to q = 0 (blue), q = 0.5 (grey), and q = 1 (red).

FIG. 4. Committor and strings of the Diels–Alder reaction before and after the Voronoi tesselation merging (a). The converged CCS and committor after three iterations (b). The reactants and product are shown in panel c.

tion [21, 22], initiated from configurations sampled at the separatrix, that is at q = 0.5. This committor-consistent

(a)(b)(c)∗ chipot@illinois.edu

[1] M. Moradi and E. Tajkhorshid, Mechanistic picture for conformational transition of a membrane transporter at atomic resolution, Proc. Natl. Acad. Sci. U.S.A. 110, 18916 (2013).

[2] K. Lindorff-Larsen, S. Piana, R. O. Dror, and D. E. Shaw, How Fast-Folding Proteins Fold, Science 334, 517 (2011). [3] A. Ajaz, A. Z. Bradley, R. C. Burrell, W. H. H. Li, K. J. Daoust, L. B. Bovee, K. J. DiRico, and R. P. Johnson, Concerted vs stepwise mechanisms in dehydro-diels–alder reactions, J. Org. Chem. 76, 9320 (2011).

[4] S. Yang, N. K. Banavali, and B. Roux, Mapping the con- formational transition in src activation by cumulating the information from multiple molecular dynamics trajecto- ries, Proc. Natl. Acad. Sci. U.S.A. 106, 3776 (2009). [5] D. Wulferding, H. Kim, I. Yang, J. Jeong, K. Barros, Y. Kato, I. Martin, O. E. Ayala-Valenzuela, M. Lee, H. C. Choi, F. Ronning, L. Civale, R. E. Baumbach, E. D. Bauer, J. D. Thompson, R. Movshovich, and J. Kim, Domain engineering of the metastable domains in the 4f-uniaxial-ferromagnet CeRu2Ga2B, Sci. Rep. 7, 46296 (2017).

[6] G. Biroli and J. Kurchan, Metastable states in glassy

systems, Phys. Rev. E 64, 016101 (2001).

[7] D. Lucente, C. Herbert, and F. Bouchet, Committor functions for climate phenomena at the predictability margin: The example of El Ni˜no–Southern Oscillation in the Jin and Timmermann model, J. Atmos. Sci 79, 2387 (2022).

[8] H. Chen and C. Chipot, Enhancing sampling with free- energy calculations, Curr. Opin. Struct. Biol. 77, 102497 (2022).

[9] J. Rogal, Reaction coordinates in complex systems-a per-

spective, Eur. Phys. J. B 94, 223 (2021).

[10] D. Branduardi, F. L. Gervasio, and M. Parrinello, From A to B in free energy space, J. Chem. Phys. 126, 054103 (2007).

[11] W. E and E. Vanden-Eijnden, Transition-path theory and path-finding algorithms for the study of rare events, Annu. Rev. Phys. Chem. 61, 391 (2010).

[12] W. E, W. Ren, and E. Vanden-Eijnden, Finite tempera- ture string method for the study of rare events, J. Phys. Chem. B 109, 6688 (2005).

[13] L. Maragliano, A. Fischer, E. Vanden-Eijnden, and G. Ci- ccotti, String method in collective variables: Minimum free energy paths and isocommittor surfaces, J. Chem. Phys. 125, 024106 (2006).

[14] A. C. Pan, D. Sezer, and B. Roux, Finding transition pathways using the string method with swarms of trajec- tories, J. Phys. Chem. B 112, 3432 (2008).

[15] H. Fu, H. Chen, X. Wang, H. Chai, X. Shao, W. Cai, and C. Chipot, Finding an optimal pathway on a multi- dimensional free-energy landscape, J. Chem. Inf. Model. 60, 5366 (2020).

[16] E. Vanden-Eijnden and F. A. Tal, Transition state the- ory: Variational formulation, dynamical corrections, and error estimates, J. Chem. Phys. 123, 184103 (2005). [17] S. V. Krivov, Protein Folding Free Energy Landscape along the Committor - the Optimal Folding Coordinate, J. Chem. Theory and Comput. 14, 3418 (2018).

[18] B. Roux, Transition rate theory, spectral analysis, and

7

reactive paths, J. Chem. Phys 156, 134111 (2022). [19] Z. He, C. Chipot, and B. Roux, Committor-consistent variational string method, J. Phys. Chem. Lett. 13, 9263 (2022).

[20] H. Chen, B. Roux, and C. Chipot, Discovering reaction pathways, slow variables, and committor probabilities with machine learning, J. Chem. Theory Comput. 19, 4414 (2023).

[21] A. Berezhkovskii and A. Szabo, One-dimensional reac- tion coordinates for diffusive activated rate processes in many dimensions, J. Chem. Phys. 122, 014503 (2005).

[22] M. D. Louwerse and D. A. Sivak, Information thermody- namics of the transition-path ensemble, Phys. Rev. Lett. 128, 170602 (2022).

[23] A. Meg´ıas, S. Contreras Arredondo, C. G. Chen, C. Tang, B. Roux, and C. Chipot, Iterative variational learning of committor-consistent transition pathways using artificial neural networks, Nat. Comput. Sci. 5, 592–602 (2025).

[24] S. Yan and T. Schlick, Heterogeneous and multiple con- formational transition pathways between pseudoknots of the SARS-CoV-2 frameshift element, Proc. Natl. Acad. Sci. U.S.A. 122, e2417479122 (2025).

[25] Y. Meng, D. Shukla, V. S. Pande, and B. Roux, Transi- tion path theory analysis of c-src kinase activation, Proc. Natl. Acad. Sci. U.S.A. 113, 9193 (2016).

[26] B. Barz, E. Rodner, Y. G. Garcia, and J. Denzler, De- tecting regions of maximal divergence for spatio-temporal anomaly detection, IEEE Trans. Pattern Anal. Mach. In- tell. 41, 1088 (2019).

[27] A. Meg´ıas and A. Santos, Hydrodynamics of granular gases of inelastic and rough hard disks or spheres. II. Stability analysis, Phys. Rev. E 104, 034902 (2021). [28] J. Harris and B. Roux, Membrane permeability of su- crose calculated from equilibrium time-correlation func- tions using molecular dynamics simulations with en- hanced sampling, J. Phys. Chem. B 129, 7172 (2025).

[29] S. Kumar, J. M. Rosenberg, D. Bouzida, R. H. Swend- sen, and P. A. Kollman, The weighted histogram analy- sis method for free-energy calculations on biomolecules. i. the method, J. Comput. Chem. 13, 1011 (1992). [30] P. Metzner, C. Sch¨utte, and E. Vanden-Eijnden, Illustra- tion of transition path theory on a collection of simple examples, J. Chem. Phys. 125, 084110 (2006).

[31] P. Metzner, C. Sch¨utte, and E. Vanden-Eijnden, Transi- tion Path Theory for Markov Jump Processes, Multiscale Model. Simul. 7, 1192 (2009).

[32] L. Rosso, J. B. Abrams, and M. E. Tuckerman, Mapping the backbone dihedral free-energy surfaces in small pep- tides in solution using adiabatic free-energy dynamics, J. Phys. Chem. B 109, 4162 (2005).

[33] J. H´enin, G. Fiorin, C. Chipot, and M. L. Klein, Explor- ing multidimensional free energy landscapes using time- dependent biases on collective variables, J. Chem. Theory Comput. 6, 35 (2010).

[34] P. G. Bolhuis, C. Dellago, and D. Chandler, Reaction coordinates of biomolecular isomerization, Proc. Natl. Acad. Sci. U.S.A. 97, 5877 (2000).

[35] P. Kang, E. Trizio, and M. Parrinello, Computing the committor with the committor to study the transition state ensemble, Nat. Comput. Sci. 4, 451–460 (2024). [36] E. Trizio, P. Kang, and M. Parrinello, Everything every- where all at once: a probability-based enhanced sampling approach to rare events, Nat. Comput. Sci. 5, 582–591 (2025).

8

[37] J. Lee, I.-H. Lee, I. Joung, J. Lee, and B. R. Brooks, Finding multiple reaction pathways via global optimiza- tion of action, Nat. Commun. 8, 15443 (2017).

[38] P. Tiwary and B. J. Berne, Predicting reaction coordi- nates in energy landscapes with diffusion anisotropy, J. Chem. Phys. 147, 152701 (2017).

[39] H. Chen, D. Ogden, S. Pant, W. Cai, E. Tajkhorshid, M. Moradi, B. Roux, and C. Chipot, A companion guide to the string method with swarms of trajectories: Char- acterization, performance, and pitfalls, J. Chem. Theory Comput. 18, 1406 (2022).

[40] H. Fu, X. Shao, W. Cai, and C. Chipot, Taming rugged free energy landscapes using an average force, Acc. Chem. Res. 52, 3254 (2019).

SupplementalMaterial:FollowingtheCommittorFlow:AData-DrivenDiscoveryofTransitionPathwaysChengGiuseppeChen

,1ChenyuTang

,1AlbertoMegías

,2RaduA.Talmazan

,1SergioContrerasArredondo

,1BenoîtRoux

,3,4andChristopheChipot

1,3,5,∗1LaboratoireInternationalAssociéCentreNationaldelaRechercheScientifiqueetUniversityofIllinoisatUrbana-Champaign,UnitéMixtedeRecherchen◦7019,UniversitédeLorraine,B.P.70239,54506Vandœuvre-lès-Nancycedex,France2ComplexSystemsGroupandDepartmentofAppliedMathematics,UniversidadPolitécnicadeMadrid,Av.JuandeHerrera6,E-28040Madrid,Spain3DepartmentofBiochemistryandMolecularBiology,UniversityofChicago,Chicago,USA4DepartmentofChemistry,UniversityofChicago,Chicago,USA5TheoreticalandComputationalBiophysicsGroup,BeckmanInstitute,andDepartmentofPhysics,UniversityofIllinoisatUrbana-Champaign,Urbana,USACONTENTSS1.SimulationandLearningdetailsS1A.ThevariationalcommittornetworkS1B.Triple-wellpotentialS2C.NANMAisomerizationinvacuumS2D.TrialanineconformationalequilibriainvacuumS3E.Diels–AlderreactionS3S2.PathwaysintrialanineisomerizationS4S3.ConvergenceoftheworkflowS5S4.CombiningWTM-eABF-PCVcalculationsintoacompleteequilibriumdistributionS6A.Histogram-lessWHAMS61.TimecorrelationfunctionS7B.ResultsS7S5.EstimationoftherateconstantsS7ReferencesS10S1.SIMULATIONANDLEARNINGDETAILSAllmoleculardynamics(MD)simulationswereperformedusingtheMDpackageNAMD3.0.1[1]andtheColvarslibrary[2].Allthebiasedsimulationswererunusingwell-tempererdmetadynamicsextendedadaptivebiasingforce(WTM-eABF)algorithm[3],withtheexceptionofthestudyoftheDiels–Alderreaction,wheremultiple-walker(MW)WTM-eABF[3,4]wasemployedinstead.AlltheMDsimulationswhereperformedataconstanttemperatureof300KthroughtheuseoftheLangevinthermostat,withanintegrationtimestepof0.5fs.ThecovalentbondsinvolvinghydrogenwereconstrainedusingtheRATTLEalgorithm[5].A.ThevariationalcommittornetworkThevariationalcommittornetwork(VCN),aspresentedinRef.[6],constistson4layersof32nodeseachwithELU[7]asactivationfunctionforeach.Thisartificialneuralnetwork(ANN)isfoundedontheminimizationofthe∗chipot@illinois.eduS2followinglossfunction,LVCN[qω]=2C[qω;τ],(S1)whichisbasedonthevariationalprincipleintroducedinRefs.[8,9],withqωcomputedasqω(z)=0,ifz∈A,Fω(z),ifz∈(A∪B)c,1,ifz∈B,(S2)whereFωisthescalarfunctionlearnedbytheVCN,andωreferstotheparametersoftheANN.However,Eq.(S2)doesnotguaranteetheboundednessoftheoutputwithintheinterval[0,1],asillustratedintheoriginalpaper(Ref.[6]),whereregionswithvaluesoutsidethisintervalareshowningrey.Toaddressthisissue,weaddedafinallayerconsistingofasinglenodewithasigmoidactivationfunction,σ(x):=1/(1+e−x),whichstrictlyconstrainstheoutputtothe[0,1]range.Additionally,followingtheapproachinRef.[10],weincludedalosstermontherestraintstoenforceacontinuousmappingattheboundariesbetween(A∪B)candthebasins.ThetotallossfunctionisthereforegivenbyL[qω]=2C[qω;τ]+λ(|Fω(z)|2z∈A+|Fω(z)−1|2z∈B),(S3)withλ∈R+aconstantsetaprioritocontroltheboundaryloss.Finally,wekeptthesamenumberoflayersoftheoriginalVCNandextendedtheirnumberofnodesto64nodestoimprovethelearningprocess.B.Triple-wellpotentialThetriple-wellpotentialstudiedinthisworkisdefinedas,V(x,y)=3e−x2−(y−13)2−3e−x2−(y−53)2−5e−(x−1)2−y2−5e−(x+1)2−y2+210x4+210(y−13)4.(S4)FortheMDsimulations,adampingcoeﬀicientof100ps−1wasusedfortheLangevinthermostat.FortheWTM-eABFalgorithm,thePCVwassampledbetween0.1and0.9,withabinwidthof0.01.Harmonicwallswithaforceconstantof1kcal/molwereplacedtorestrainthesystemwithinaPCVvalueof0.1and0.9.Aftertheinitialsamplingoftheiterativemethod,anadditionalharmonicwallofforceconstant30kcal/(mol·Å4)wasplacedtorestrainthevalueoftheorthogonalPCV,ζ(seeitsdefinitioninEq.(S6)[11]),below0.2Å2.Thebiasingforcewasappliedafter100sampleswerecollectedineachbin,usinganextendedfluctuationof0.01,anextendedtimeconstantof200fs,abiastemperatureof1,000KdepositingtheGaussianbiasingpotentialswithaninitialheightof0.1kcal/mol,awidthof0.03Åandafrequencyof1every1,000steps.Fortheinitialsampling,werana10nsPCVsimulationalongthestraightpathconnectingthetwobasins[A=(−1,0)andB=(1,0)].Forthefollowingthreeiterations,werana5nsPCVsimulationforeachCCS.Onlythelast8nsfromtheinitialsamplingandthelast4nsfortheotheriterationswereusedtotraintheVCN.Afterthefinaliteration,2,000unbiasedsimulationsof30pseachwereperformedstartingfromconformationssampledinthePCVsimulationsalongtheconvergedCCSs.ForthetrainingoftheVCN,thetime-correlationfunctionofthecommittorqwascalculatedusingatime-lagτof100fs.Thetrainingswereperformedwithamaximumnumberofepochsof5,000,withanearlystoppingsetat20epochs.Thegradient-guidedpathsweregeneratedateachiterationbyrandomlyselecting500sampledpointsclosetotheseparatrixastheinitialpoints.Then,theywereclusteredusinghierarchicalclustering,basedontheRMSDbetweendifferentstrings,withacut-offheightof0.6Å.C.NANMAisomerizationinvacuumNANMAinvacuumwassimulatedusingtheCHARMM22forcefield[12].Adampingcoeﬀicientof10ps−1wasusedfortheLangevinthermostat.Fortheinitialsampling,weperformeda5nsWTM-eABFsimulationusing,asCVs,thetworootmeansquaredisplacements(RMSDs)oftheheavyatomswithrespecttoconformationsC7eqandC7ax.TheCVsweresampledintherangebetween0.1and1.8Åwithabinwidthof0.05Å.Harmonicwallsofforceconstant1kcal/(mol·Å2)weresettorestraintheRMSDswithin0.1and1.8Å.TheregionsintheCVsubspaceS3thatremainedunsampledafter1nsweremaskedfortherestofthesimulationinordertoavoidnonphysicalregions(e.g.,wherebothRMSDsaresuﬀicientlysmall).Thebiasingforcewasappliedafter5,000sampleswerecollectedineachbin,usinganextendedfluctuationof0.01Å,anextendedtimeconstantof200fs,abiastemperatureof2,000KdepositingtheGaussianbiasingpotentialswithaninitialheightof0.1kcal/mol,awidthof0.1Åandafrequencyof1every1,000steps.Forthefollowingiterations,weperformed5nsPCVsimulationsforeachCCS.ThePCVwassampledbetween0.05and0.95,withabinwidthof0.01.HarmonicwallsweresettorestrainthePCVwithin0.05and0.95usingforceconstantsof1kcal/mol,andζbelow600degree2usingaforceconstantof0.001kcal/moldegree4.ThesameWTM-eABFparameterswereusedfortheeABFportionofthealgorithm.FortheWTMpart,weemployedabiastemperatureof1,000K,aninitialhillheightof2kcal/mol,ahillwidthof0.02andafrequencyof1every1,000steps.Afterthefinaliteration,4,000unbiasedsimulationsof10pseachwereperformedstartingfromconformationssampledinthePCVsimulationsalongtheconvergedCCSs.ForthetrainingoftheVCN,onlythelast4nsofeachbiasedsimulationwasused.Thetime-correlationfunctionofthecommittorqwascalculatedusingatime-lagτof100fs.TheVCNconsistedof4layerswith64nodeseach,andthetrainingswereperformedwithamaximumnumberofepochsof5,000,withanearlystoppingsetat20epochs.Fortheinitialsampling,300initialpointswereusedtogeneratethegradient-guidedpathways.Forthefollowingiterations,200initialpointswereusedexceptforthefinaliteration,where1,000pointswereselectedinstead.Thestringpathwayswerethenclusteredusinghierarchicalclusteringusingacut-offheightof0.3°.D.TrialanineconformationalequilibriainvacuumTrialanineinvacuumwassimulatedusingtheAMBERff14SBforcefield[13]andadampingcoeﬀicientof1ps−1.Fortheinitialsampling,weperformeda120nsWTM-eABFsimulationusing,asCVs,thetwoRMSDsoftheheavy-atomspositionswithrespecttothoseofconformationsA(ϕ1=60◦,ϕ2=−70◦,ϕ3=60◦)andB(ϕ1=−70◦,ϕ2=60◦,ϕ3=−70◦).TheCVsweresampledintherangebetween0.05and5.05Åwithabinwidthof0.1Å.Harmonicwallsofforceconstant100kcal/(mol·Å2)weresettorestraintheRMSDsbelow5.5Å.TheregionsintheCV-subspacethatremainedunsampledafter1nsweremaskedfortherestofthesimulationinordertoavoidnonphysicalregions.Thebiasingforcewasappliedafter1,000sampleswerecollectedineachbin,usinganextendedfluctuationof0.02Å,anextendedtimeconstantof100fs,abiastemperatureof4,000KdepositingtheGaussianbiasingpotentialswithaninitialheightof0.1kcal/mol,awidthof0.2Åandafrequencyof1every1,000steps.Forthefollowingiterations,weperformed10nsPCVsimulationsforeachCCS.ThePCVwassampledbetween0.05and0.95,withabinwidthof0.01.HarmonicwallsweresettorestrainthePCVwithin0.05and0.95usingforceconstantsof1kcal/mol,andζbelow500degree2usingaforceconstantof0.001kcal/moldegree4.Thebiasingforcewasappliedafter1,000sampleswerecollectedineachbin,usinganextendedfluctuationof0.01,anextendedtimeconstantof200fs,abiastemperatureof4,000KdepositingtheGaussianbiasingpotentialswithaninitialheightof0.2kcal/mol,awidthof0.02andafrequencyof1every1,000steps.Afterthefinaliteration,900unbiasedsimulationsof200pseachwereperformedstartingfromconformationssampledinthePCVsimulationsalongtheconvergedCCSs.ForthetrainingoftheVCN,fortheinitialstepoftheiterativeprocess,thelast80nsofsamplingwasused.Forthefollowingiterations,thelast5nsofeachsimulationwasused.Thetime-correlationfunctionofthecommittorqwascalculatedusingatime-lagτof100fs.TheVCNconsistedof4layerswith64nodeseach,andthetrainingswereperformedwithamaximumnumberofepochsof5,000,withanearlystoppingsetat20epochs.Fortheinitialsampling,800initialpointswereusedtogeneratethegradient-guidedpathways.Forthefollowingiterations,2,000initialpointswereused.Thestringpathwayswerethenclusteredusinghierarchicalclusteringmakinguseofacut-offheightof0.3°.Inthecaseswherethecut-offheightwasnotclearlyidentifiable,avalueof0.3°wasstillemployedand,afterwards,theclusteredstringpathwaysweremergedusingtheVoronoi-cellcriterion,followedbyanadditionalhierarchicalclusteringanalysis.E.Diels–AlderreactionTheDiels–Alderreactionofethylenewithvinylacetylenetoformcyclohexadienewassimulatedinimplicitsolvent(Dimethylformamide)usingGFN2-xTB.EnhancesamplingalongtheRMSDsdefinedwithrespecttothebasinswasnotutilizedduetotheirstrongdegeneracyforthissystem,aswellasthepresenceofconvergenceissuesattheself-consistentfielditerationlevel.Therefore,Theinitialsamplingwasobtainedbybiasingoneofthedistancesbetweenthecarbonatomsinvolvedinbondformation.Toensurerelevantsamplingofthebondformationprocessandtosuppressdissociativeconfigurationsofthereactants,restraintswereimposedontheinteratomicdistancescorrespondingtothenewlyformedbonds.Aharmonicpotentialwasappliedwithawallpositionedat3.5Å,usingaforceconstantof100S4kcal/molÅ2.Additionally,topreventsamplingbiasarisingfromchemicallyequivalentspeciesdifferingintopology,atorsionalrestraintwasintroduced.Thiswasdefinedviathedihedralangleformedbyatoms6–2–0–1andconfinedwithintheintervalof−80◦to+80◦,enforcedusingharmonicwallswithaforceconstantof10kcal/(moldegree2).Thesimulationemployed32walkers,eachpropagatedfor1ns,withgradientsharingoccurringevery1,000steps.Langevindynamicswereusedtomaintainatemperatureof300K,applyingadampingcoeﬀicientof10ps−1.FortheextendedLangevinformulation,parametersweresettoadampingcoeﬀicientof1ps−1,anextendedfluctuationmagnitudeof0.01Å,andanextendedtimescaleof200fs.Thesamplingwasdiscretizedinto73binswiththewidthof0.05Å.Thebiasingforcewasappliedonceeachbinaccumulatedathresholdof5,000samples.Inthewell-temperedmetadynamicscomponent,thebiastemperaturewassetto2,000K,withhillsdepositedevery1,000steps,havingaGaussianwidthof0.028Å,andahillheightof0.1kcal/mol.Forthefollowingiterations,weperformed16ns(0.5nsperwalker)PCVsimulationsalongthedeterminedCCSsconnectingthetwobasins(A={2.8Å≤d1,d2≤3.6Å}andB={1.4Å≤d1,d2≤1.8Å}).ThePCVwassampledbetween0.0and1.0,withabinwidthof0.01.HarmonicwallsweresettorestrainthePCVwithin0.0and1.0usingaforceconstantof1kcal/mol.Thebiasingforcewasappliedafter5,000sampleswerecollectedineachbin,usinganextendedfluctuationof0.01,anextendedtimeconstantof200fs,abiastemperatureof14,000KdepositingtheGaussianbiasingpotentialswithaninitialheightof0.1kcal/mol,awidthof1.0andafrequencyof1every1,000steps.Afterthefinaliteration,1,000unbiasedsimulationsof10pseachwereperformedstartingfromconformationssampledinthePCVsimulationsalongtheconvergedCCSs.ForthetrainingoftheVCNs,thelast0.4nsofsamplingfromeachwalkerwereused.Thetime-correlationfunctionofthecommittorqwascalculatedusingatime-lagτof100fs.TheVCNwastrainedwithamaximumnumberofepochsof15,000andwithanearly-stoppingnumberofepochssetat20.Fortheeachsampling,500initialpointswereusedtogeneratethegradient-guidedpathways.Thestringpathwayswerethenclusteredusinghierarchicalclusteringusingacut-offheightof0.17Å.TheclusteredstringpathwayswerethenmergedaccordingtotheexchangebetweenVoronoicells,afterwhichanadditionalhierarchicalclusteringanalysiswasperformed.S2.PATHWAYSINTRIALANINEISOMERIZATIONInTableS1,weshowthemainmetastablestatesoftrialanineisomerizationinvacuum,whicharealsodepictedinFig.S1withinareferencefree-energylandscape.Moreover,the21pathwaysobtainedbythepresentedmethodologyaredescribedschematicallyinTableS2.TABLES1.Positionsinthe(ϕ1,ϕ2,ϕ3)subspaceofthemainmetastablestatesoftrialanineinvacuum[14].ϕ1(◦)ϕ2(◦)ϕ3(◦)A60-7060B-7060-70M1-70-7060M260-70-70M3-70-70-70M4-706060M5606060M66060-70S5M1M2M3M4M5M61.63.24.86.48.0PMF (kcal/mol)FIG.S1.Freeenergylandscapeoftrialanineinvacuumprojectedontothe(ϕ1,ϕ2,ϕ3)subspaceobtainedfromaWTM-eABFsimulationusingϕ1,ϕ2,andϕ3asCVs.Allthemainmetastablestates(seeTableS1andRef.[14])arelabelled.TABLES2.SchematicdescriptionoftheconvergedCCSsfortheisomerizationoftrialanineinvacuum.Eachpathisdescribedthroughthemetastablestatesencountered(seeTableS1andFig.S1).“–”indicatestrialaninetransitionsbetweenthetwobasinswithoutcrossingtheperiodicboundariesoftheCVs;otherwise,thetransitionbetweenthebasinsisindicatedwith“=”.PathlabelPathdescription1A=M1–M4=B2A=M1–M4–B3A–M5–M4=B4A–M1–M4=B5A–M5–M4–B6A–M1–M4–B7A–M2–M6=B8A–M2–M6–B9A=M2–M6–B10A=M2–M3–B11A–M2–M3=B12A–M2–M3–B13A=M3=B14A=M2=M3–B15A=M1=M3–B16A–M1=M3=B17A–M1=M3–B18A=M1–M3=B19A–M1–M3=B20A=M1–M3–B21A–M1–M3–BS3.CONVERGENCEOFTHEWORKFLOWInTableS3,wepresenttheKLDvaluesforthedifferentiterationsofthestudiedprocess.Inallofthem,within3iterationsthevaluesconstantlydecreaseinoneormoreordersofmagnitudefromtheinitialsampling,indicatingaconvergenceofthemethod.S6TABLES3.ValueoftheKLD,D(k),(seeEq.3ofthemaintext)forthedifferentsystemsanditerations.Iteration,kTriplewellNANMATrialanineDiels–Alder13.52×10−13.62×10−12.354.73×10−225.49×10−37.78×10−21.221.94×10−232.58×10−31.00×10−28.65×10−16.92×10−4S4.COMBININGWTM-EABF-PCVCALCULATIONSINTOACOMPLETEEQUILIBRIUMDISTRIBUTIONA.Histogram-lessWHAMWewishtoperformenhancedsamplinginasubspaceofCVs,z,usingNwindependentWTM-eABF-PCVcalcu-lationsalongdifferentpathways.Theresultofthei–thcalculationyieldsthebiasingpotentialswi(z).ThePCVisdefinedfromadiscretizedstring{˜zk}mk=1as[11],s(z)=m∑k=1k−1m−1(e−αd(z,˜zk)2∑mℓ=1e−αd(z,˜zℓ)2),(S5)whered(·,·)isadistance,andα∈R+isapositiveconstantthatcontrolsthesmoothnessofthequantity.Inaddition,onedefinesanorthogonalvariable,ζ(z)=−1αlnm∑ℓ=1e−αd(z,˜zℓ)2.(S6)Hence,foreachstringi,onecandefineasi(z)andζi(z),fromwhichthei-thPCVcalculationiscarriedout.Onceitisconverged,theABFcalculationflattenthefreeenergylandscapealongthesicoordinate(cancelsthePMFofthesystemalongsi)whilethebiasingpotentialorthogonaltothereactiontuberemains.Therefore,theconvergedbiasingpotentialwi(z)isgivenby,wi(z)=−Vb[si(z)]+u⊥[ζi(z)],(S7)whereVbistheone-dimensionalbiasingpotentialdeterminedbytheenhancedsamplingmethod(WTM-eABFintheparticularcaseofthiswork),andu⊥referstothedirectionperpendiculartothedirectionofapplicationofVb.Theindividualunbiasedequilibriumdistributionfunctioninthespacezcoincideswith,⟨ρ(z)⟩(i)unb=e+βwi(z)⟨ρ(z)⟩(i)be−βFi,(S8)where⟨ρ(z)⟩(i)isthei–thbiaseddistributionandFiissomeconstanttobedetermined.TheWHAMequationsexpresstheoptimalestimatefortheunbiaseddistributionfunctionasaz-dependentweightedsumovertheNwindividualunbiaseddistributionfunctions:⟨ρ(z)⟩=Nw∑i=1⟨ρ(z)⟩(i)unb(nie−β(wi(z)−Fi)∑Nwj=1nje−β(wj(z)−Fj))=Nw∑i=1ni⟨ρ(z)⟩(i)bNw∑j=1nje−β(wj(z)−Fj)−1=Hb(z)R(z),(S9)whereniisthenumberofindependentdatapointsusedtoconstructthebiaseddistributionfunction,Hb(z)isthecumulativehistogramofallthebiasedsimulations,Hb(z)=Nw∑i=1ni⟨ρ(z)⟩(i)b→∑tδ(zb(t)−z),(S10)S7wherezb(t)referstothevalue,inCV-space,ofthebiasedtrajectoryattimet,andR(z)isthereweighingfactor,R(z)=Nw∑j=1nje−β(wj(z)−Fj)−1.(S11)Then,ineffect,wehave⟨ρ(z)⟩→∑tδ(zb(t)−z)R(zb(t)),(S12)wheretarethesnapshotsalongtheWTM-eABF-PCVtrajectories.ThefreeenergyconstantsFi,neededinEq.(S9),aredeterminedusingtheoptimalestimateforthedistributionfunction:e−βFi=∫dze−βwi(z)⟨ρ(z)⟩.(S13)Sincethedistributionfunctionitselfdependsonthesetofconstants{Fj},theWHAMEqs.(S9)and(S13)mustbesolvedself-consistentlythroughaniterationprocedure.InpracticewecouldsetoneoftheFitoafixedvalue.LetusassumethatwesetF1=0,thenthefreeenergyconstantsFi,neededinEq.(2),aredeterminedusing,e−β(Fi−F1)=∫dze−βwi(z)⟨ρ(z)⟩∫dze−βw1(z)⟨ρ(z)⟩≈∑te−βwi(zb(t))R(zb(t))∑t′e−βw1(zb(t′))R(zb(t′)).(S14)Thisistheso-calledhistogram-lessversionofWHAM.StartingfromaninitialguessfortheNwfreeenergyconstantsFi,anestimatefortheunbiaseddistributionisobtainedfromEq.(S9).Thisestimatefor⟨ρ(z)⟩isusedinEq.(S13)togeneratenewestimatesfortheNwfreeenergyconstantsFi,andanewunbiaseddistributionisgeneratedwithEq.(S9).Theiterationcycleisrepeateduntilbothequationsaresatisfied.1.TimecorrelationfunctionOncetheunbiasedequilibriumdistributionhasbeenobtained,itispossibletocalculatetheunbiasedtime-correlationfunctionofthecommittor,C[q;t],C[q;t]=12⟨(q(t)−q(0))2⟩.(S15)Weexpressthetime-correlationfunctionofinterestasanaverageoverequilibriuminitialconditionszi,pickedfromtheconfigurationsalongthebiasedABFtrajectorieszb(t):C[q;t]=∫dz⟨ρ(z)⟩c[q(zi);t]≈∑iR(zi)czi[q;t]∑jR(zj),c[q(zi);t]≡czi[q;t]=1ntnt∑k=0(q(z(t+k∆t|zi))−q(z(k∆t|zi)))2,(S16)wherethetime-correlationfunctionczi[q;t]iscalculatedasanaverageovertimefromanewunbiasedtrajectoryinitiatedatzi,where∆trepresentsthetimestepofthetrajectories.Finally,oncethisisdoneandwelearnedacommittorq,andwehaveC(t)≡C[q;t],thesteady-statefluxcanberecoveredasJAB=limt→τq˙C(t),(S17)withτqafiniterelaxationtime,notnecessarythesameasthetimelagusedintheVCN.B.ResultsS5.ESTIMATIONOFTHERATECONSTANTSToestimatetherateconstantforthetransitionprocessathand,thediscussioninSec.S4A1isused.AfterafinalsetofunbiasedtrajectoriesinitiatedfromrandomlyselectedinitialconditionsfromthePCVcalculationsinS8(a)(b)FIG.S2.(a)Triple-wellpotentialobtainedfrombin-lessWHAMcombiningthesamplingofthePCVsimulationsalongtheconvergedCCSs.(b)Learnedcommittor,q,forthetriple-wellpotentialobtainedfromshortunbiasedsimulationsbyshootingfrompointssampledduringthePCVsimulationsalongtheconvergedCCSs.Thegraylinesin(b)correspondtodifferentcontourlinesofthetriple-wellpotential.(a)(b)FIG.S3.(a)Freeenergylandscapeand(b)learnedcommittor,q,ofNANMAisomerizationinvacuumprojectedontothe(ϕ,ψ)-subspaceandwithθ=ω=0◦obtainedfromthehistogram-lessWHAMcombiningthesamplingofthedifferentPCVcalculationsalongtheconvergedCCSs.Thegraylinesin(b)correspondtodifferentcontourlinesofareferencefreeenergylandscape.FIG.S4.(a)Freeenergylandscapeoftrialanineinvacuumprojectedontothe(ϕ1,ϕ2,ϕ3)-subspaceobtainedfrombin-lessWHAMcombiningthesamplingofthePCVsimulationsalongtheconvergedCCSs.(b)LearnedcommittorqfortheA→Bisomerizationoftrialanineinvacuumprojectedontothe(ϕ1,ϕ2,ϕ3)-subspaceobtainedfromshortunbiasedsimulationsbyshootingfrompointssampledduringthePCVsimulationsalongtheconvergedCCSs.S9thelastiterationoftheworkflow,welearnedacommittorusingtheVCN,andcomputepAandC[q,τ]fordifferentvaluesofτ.InFigs.S2–S4,weshowthefree-energylandscapesobtainedbyusingtheWHAM,aswellasthefinallearnedcommittorfromtheunbiasedtrajectoriessimulatedaftertheconvergenceofthemethodologyforthetriple-wellpotentialandNANMAandtrialanineisomerizations,respectively.InthecaseoftheDiels–Alderreaction,thereisnoneedofusageofWHAM,sinceasinglestringpathwayisobtained.TheestimatesarecomputedfollowingEq.S16.Moreover,thevarianceofthecorrelationfunctionisdefinedasfollows[15],Var[C[q,τ]]=∑iR2(zi)Var[czi[q,τ]](∑jR(zj))2.(S18)Ineveryparticularcomputation,Var[czi[q,τ]]isestimatedwiththecorrespondingsamplingvarianceforthei-thunbiasedtrajectory.Then,theerrorassociatedwitheachpunctualestimateofthetotalcorrelationfunctionisidentifiedwiththecorrespondingstandarddeviation,i.e.,thesquarerootoftheestimatedvariance.InordertoensurethelinearregimeinwhichwecancomputetheslopeinEq.(S17),weidentifytheendofafirstrelaxationprocessrelatedtotheequilibrationoftheinitialstructures.Oncetheseinitialrelaxationtimesareappropriatelyselected,wecomputetheslopeanditsuncertaintyusingbootstrapping[16,17]ontheestimatoroftheassociatedlinearregression.Thereasonofusingabootstrappingresamplingismotivatedbythepresenceofheterocedasticity.Thebootstrapisperformedusing10,000resamplingsontheselectedpointsforthelinearregression.Theestimateoftheslopeisidentifiedwiththeconfidenceintervalat99%ofconfidencelevel.DuetotheassumptionofGaussiandistributionforeachpointusedinthelinearregression,theintervalsaresymmetricaroundthesamplingmean.Moreover,itisworthnotingthat,inthecaseofthetwo-dimensionaltriple-wellpotential,thereisnoneedtowaitforafirstrelaxationduetotheabsenceofmolecularstructure.InFig.S5,weshowtheresultsoftherateconstantsestimatesforthedifferenttransitions.(a)(b)(c)(d)FIG.S5.RateconstantkABdeterminedfromtheresultingcommittorslearnedbytheVCNtrainedonshortunbiasedsimula-tionsof:(a)thetriple-wellpotential;(b)theisomerizationofNANMA;(c)trialanineconformationalequilibriuminvacuum;(d)Diels–Alderreactionofvinyl-acetyleneandbutyneinimplicitsolvent(dimethylformamide).S10[1]J.C.Phillips,D.J.Hardy,J.D.C.Maia,J.E.Stone,J.V.Ribeiro,R.C.Bernardi,R.Buch,G.Fiorin,J.Hénin,W.Jiang,R.McGreevy,M.C.R.Melo,B.K.Radak,R.D.Skeel,A.Singharoy,Y.Wang,B.Roux,A.Aksimentiev,Z.Luthey-Schulten,L.V.Kalé,K.Schulten,C.Chipot,andE.Tajkhorshid,ScalablemoleculardynamicsoncpuandgpuarchitectureswithNAMD,J.Chem.Phys.153,044130(2020).[2]G.Fiorin,F.Marinelli,L.R.Forrest,H.Chen,C.Chipot,A.Kohlmeyer,H.Santuz,andJ.Hénin,Expandedfunctionalityandportabilityforthecolvarslibrary,J.Phys.Chem.B128,11108(2024).[3]H.Fu,X.Shao,W.Cai,andC.Chipot,Tamingruggedfreeenergylandscapesusinganaverageforce,Acc.Chem.Res.52,3254(2019).[4]K.Minoukadeh,C.Chipot,andT.Lelièvre,Potentialofmeanforcecalculations:Amultiple-walkeradaptivebiasingforceapproach,J.Chem.TheoryComput.6,1008(2010).[5]H.C.Andersen,Rattle:A“velocity”versionoftheshakealgorithmformoleculardynamicscalculations,J.Comput.Phys.52,24(1983).[6]H.Chen,B.Roux,andC.Chipot,Discoveringreactionpathways,slowvariables,andcommittorprobabilitieswithmachinelearning,J.Chem.TheoryComput.19,4414(2023).[7]D.Clevert,T.Unterthiner,andS.Hochreiter,Fastandaccuratedeepnetworklearningbyexponentiallinearunits(elus),in4thInternationalConferenceonLearningRepresentations,ICLR2016,SanJuan,PuertoRico,May2-4,2016,ConferenceTrackProceedings,editedbyY.BengioandY.LeCun(2016).[8]P.V.BanushkinaandS.V.Krivov,Optimalreactioncoordinates,WileyInterdiscip.Rev.Comput.Mol.Sci.6,748(2016).[9]B.Roux,Transitionratetheory,spectralanalysis,andreactivepaths,J.Chem.Phys156,134111(2022).[10]A.Megías,S.ContrerasArredondo,C.G.Chen,C.Tang,B.Roux,andC.Chipot,Iterativevariationallearningofcommittor-consistenttransitionpathwaysusingartificialneuralnetworks,Nat.Comput.Sci.5,592–602(2025).[11]D.Branduardi,F.L.Gervasio,andM.Parrinello,FromAtoBinfreeenergyspace,J.Chem.Phys.126,054103(2007).[12]A.D.J.MacKerell,D.Bashford,M.Bellott,R.L.J.Dunbrack,J.D.Evanseck,M.J.Field,S.Fischer,J.Gao,H.Guo,S.Ha,D.Joseph-McCarthy,L.Kuchnir,K.Kuczera,F.T.K.Lau,C.Mattos,S.Michnick,T.Ngo,D.T.Nguyen,B.Prodhom,W.E.Reiher,B.Roux,M.Schlenkrich,J.C.Smith,R.Stote,J.Straub,M.Watanabe,J.Wiórkiewicz-Kuczera,D.Yin,andM.Karplus,All-atomempiricalpotentialformolecularmodelinganddynamicsstudiesofproteins,J.Phys.Chem.B102,3586(1998).[13]J.A.Maier,C.Martinez,K.Kasavajhala,L.Wickstrom,K.E.Hauser,andC.Simmerling,ff14sb:Improvingtheaccuracyofproteinsidechainandbackboneparametersfromff99sb,J.Chem.TheoryComput.11,3696(2015).[14]H.Chen,D.Ogden,S.Pant,W.Cai,E.Tajkhorshid,M.Moradi,B.Roux,andC.Chipot,Acompanionguidetothestringmethodwithswarmsoftrajectories:Characterization,performance,andpitfalls,J.Chem.TheoryComput.18,1406(2022).[15]J.HarrisandB.Roux,Membranepermeabilityofsucrosecalculatedfromequilibriumtime-correlationfunctionsusingmoleculardynamicssimulationswithenhancedsampling,J.Phys.Chem.B129,7172(2025).[16]B.Efron,Bootstrapmethods:Anotherlookatthejackknife,Ann.Statist.7,1(1979).[17]P.Young,EverythingYouWantedtoKnowAboutDataAnalysisandFittingbutWereAfraidtoAsk,SpringerBriefsinPhysics(Springer,Cham,2015).